"use strict";

(function () {
	//for SVG-elements in IE
	svg4everybody();
})();

//запустить какую-либо функцию, если element существует на странице
var forElement = function forElement(element) {
	return new Promise(function (resolve) {
		if (element) {
			resolve();
		}
	});
};

//проверка на мобильное устройство
var isMobile = {
	Android: function Android() {
		return navigator.userAgent.match(/Android/i);
	},
	BlackBerry: function BlackBerry() {
		return navigator.userAgent.match(/BlackBerry/i);
	},
	iOS: function iOS() {
		return navigator.userAgent.match(/iPhone|iPad|iPod/i);
	},
	Opera: function Opera() {
		return navigator.userAgent.match(/Opera Mini/i);
	},
	Windows: function Windows() {
		return navigator.userAgent.match(/IEMobile/i);
	},

	any: function any() {
		return isMobile.Android() || isMobile.BlackBerry() || isMobile.iOS() || isMobile.Opera() || isMobile.Windows();
	}
};
//Flip effect
(function () {
	document.addEventListener("DOMContentLoaded", function () {

		var authorize = document.getElementById("authorize"),
		    flipClass = "flipper";

		//login form
		if (authorize) {
			authorize.addEventListener("click", runFlip);

			//перевернуть карту при клике вне ее
			document.body.addEventListener("click", function (e) {
				if (!e) e = window.event;
				var elems = e.path,
				    flag = true;

				for (var i = 0; i < elems.length; i++) {
					if (elems[i].id === "authorize" || elems[i].id === "login") {
						flag = false;
					}
				}

				if (flag) document.getElementById("login").classList.remove(flipClass);
			});
		}

		//flip effect
		function runFlip() {
			var elem = document.getElementById(this.dataset.flipId),
			    classes = elem.classList;

			classes.contains(flipClass) === true ? classes.remove(flipClass) : classes.add(flipClass);
		}
	});
})();

//Parallax
(function () {
	document.addEventListener("DOMContentLoaded", function () {
		var layers = document.getElementsByClassName("parallax__layer"),
		    parallax = document.getElementById("parallax"),
		    wrapper = document.getElementsByClassName("wrapper")[0],
		    noParallax = document.createElement("div");

		var moveLaers = function moveLaers(e) {
			e = e || event;

			var initialX = window.innerWidth / 2 - e.pageX,
			    initialY = window.innerHeight / 2 - e.pageY;

			for (var i = 0; i < layers.length; i++) {
				var divider = void 0;

				if (layers.length >= 5) divider = i / 100;else divider = (i + 1) / 100;

				var X = initialX * divider,
				    Y = initialY * divider,
				    transformStyle = "translate3d(" + X + "px, " + Y + "px, " + "0)";

				layers[i].style.transform = transformStyle;
			}
		};

		if (isMobile.any()) {
			wrapper.removeChild(parallax);
			noParallax.className = "parallax bg_forest-bottom";
			wrapper.insertBefore(noParallax, document.getElementsByClassName("footer")[0]);
		} else {
			window.addEventListener("mousemove", moveLaers);
		}
	});
})();

//Main menu
//jQuery
$(function () {
	$('#toggle').on('click', function () {
		$(this).toggleClass('hamburger_on');
		$('#main-menu').toggleClass('main-menu_target');
	});
});

//Preloader
//jQuery
var preloader = function () {
	var percents = 0,
	    preloader = $("#preloader");

	var imgPath = $("*").map(function (i, el) {
		var bg = $(el).css("background-image"),
		    img = $(el).is("img"),
		    path = "";

		if (bg != "none") {
			path = bg.replace('url("', '').replace('")', '');;
		}

		if (img) {
			path = $(el).attr("src");
		}

		if (path) return path;
	});

	var setPercents = function setPercents(total, current) {
		var persents = Math.ceil(current / total * 100);

		$("#percrnts").text(persents);

		if (persents >= 100) {
			preloader.fadeOut();
		}
	};

	var loadImages = function loadImages(images) {

		if (!images.length) preloader.fadeOut();

		images.forEach(function (img, i, images) {
			var fakeImage = $("<img>", {
				attr: {
					src: img
				}
			});

			fakeImage.on("load error", function () {
				percents++;
				setPercents(images.length, percents);
			});
		});
	};

	return {
		init: function init() {
			var imgs = imgPath.toArray();

			loadImages(imgs);
		}
	};
}();

$(function () {
	preloader.init();
});

//Sidebar
//jQuery
var blog = document.getElementById("blog");

//если элемент blog существует
forElement(blog).then(function () {
	//модуль Sidebar
	var scrollSidebar = function () {
		var sidebar = $(".sidebar"),
		    menu = $(".sidebar-nav"),
		    link = $(".sidebar__link"),
		    article = $(".article"),
		    body = document.body,
		    isPositionArticle = [],
		    offsetHeight = $(".blog__content")[0].offsetTop - $(".main")[0].offsetTop;

		var positionArticle = function positionArticle(el) {
			for (var i = 0; i < el.length; i++) {
				isPositionArticle[i] = {};
				isPositionArticle[i].top = el.eq(i).offset().top - offsetHeight;
				isPositionArticle[i].bottom = isPositionArticle[i].top + el.eq(i).innerHeight();
			}
		};

		var menuFixed = function menuFixed() {
			var scroll = window.pageYOffset;

			if (scroll < article.offset().top) {
				sidebar.removeClass("fixed");
				$(".blog__content").removeClass("nav-fixed");
			} else {
				sidebar.addClass("fixed");
				$(".blog__content").addClass("nav-fixed");
			}
		};

		var scrollPage = function scrollPage(e) {
			var scroll = window.pageYOffset;

			for (var i = 0; i < isPositionArticle.length; i++) {
				if (scroll >= isPositionArticle[i].top && scroll <= isPositionArticle[i].bottom) {
					link.eq(i).addClass("sidebar__link_active").siblings().removeClass("sidebar__link_active");
				}
			}
		};

		var clickOnMenu = function clickOnMenu(e) {
			var index = $(e.target).index();
			var sectionOffset = article.eq(index).offset().top;
			$(document).off("scroll", scrollPage);
			$("body, html").animate({
				"scrollTop": sectionOffset
			}, function () {
				$(e.target).addClass("sidebar__link_active").siblings().removeClass("sidebar__link_active");
				$(document).on("scroll", scrollPage);
			});
		};

		var addListener = function addListener() {
			$(menu).on("click", clickOnMenu);

			$(document).on("scroll", scrollPage);
			$(document).on("scroll", menuFixed);

			$(window).on("load", function (e) {
				positionArticle(article);
			});

			$(window).on("resize", function (e) {
				positionArticle(article);
			});
		};

		return {
			init: addListener
		};
	}();

	scrollSidebar.init();

	//toggle class 
	$("#btn").on("click", function () {
		$("#blog").toggleClass("on");
	});
});

//Slider
var slider = document.getElementById("slider");

forElement(slider).then(function () {
	window.onload = function () {
		Slider.init();
	};

	var Slider = {
		init: function init() {
			this.display = document.getElementById("display");
			this.header = document.getElementById("header");
			this.description = document.getElementById("description");
			this.siteLink = document.getElementById("siteLink");
			this.btnPrew = document.getElementById("btnPrew");
			this.btnNext = document.getElementById("btnNext");
			this.btnPrewImg = document.getElementById("btnPrewImg");
			this.btnNextImg = document.getElementById("btnNextImg");

			this.works = [];

			this.duration = 1000;

			this.display.addEventListener("click", function () {
				Slider.animate({
					duration: 3000,
					timing: function timing(timeFraction) {
						return timeFraction;
					},
					draw: function draw(progress) {
						console.log(progress);
						Slider.display.style.opacity = progress;
					}
				});
			});

			//Ajax
			this.data("/assets/json/slider.json").then(function (dataArray) {
				for (var i = 0; i < dataArray.length; i++) {
					Slider.works.push(dataArray[i]);
					Slider.works[i].index = i;
				}
				//заполнить слайдер первоначальными данными
				Slider.clicking(0, dataArray.length - 1, 1);
			}).catch(function (status) {
				console.error("Код ответа: ", status);
			});

			//Events
			this.btnPrew.addEventListener("click", function (event) {
				var indexes = [Slider.display.dataset.index, Slider.btnPrewImg.dataset.index, Slider.btnNextImg.dataset.index];

				Slider.toggleIndexes(indexes, "minus");
				Slider.addAnimate(indexes[0], indexes[1], indexes[2]);
			});

			this.btnNext.addEventListener("click", function () {
				var indexes = [Slider.display.dataset.index, Slider.btnPrewImg.dataset.index, Slider.btnNextImg.dataset.index];

				Slider.toggleIndexes(indexes, "plus");
				Slider.addAnimate(indexes[0], indexes[1], indexes[2]);
			});
		},
		data: function data(url) {
			return new Promise(function (resolve, reject) {
				var xhr = new XMLHttpRequest();
				xhr.open("GET", url, true);
				xhr.responseType = "json";
				xhr.send();
				xhr.onreadystatechange = function () {
					if (xhr.readyState !== 4) return;
					if (xhr.status !== 200) {
						reject(xhr.status);
					} else {
						resolve(xhr.response);
					}
				};
			});
		},
		addTextBlock: function addTextBlock(index) {
			this.header.innerText = this.works[index].title;
			this.description.innerText = this.works[index].desc;
			this.siteLink.href = this.works[index].link;
		},
		addDisplay: function addDisplay(index) {
			this.display.src = this.works[index].image;
			this.display.alt = this.works[index].title;
			this.display.dataset.index = index;
		},
		addNextImg: function addNextImg(index) {
			this.btnNextImg.src = this.works[index].preview;
			this.btnNextImg.alt = this.works[index].title;
			this.btnNextImg.dataset.index = index;
		},
		addPrewImg: function addPrewImg(index) {
			this.btnPrewImg.src = this.works[index].preview;
			this.btnPrewImg.alt = this.works[index].title;
			this.btnPrewImg.dataset.index = index;
		},
		clicking: function clicking(displayIndex, prewIndex, nextIndex) {
			//main content in the slider: big picture, title, description and link
			this.addDisplay(displayIndex);
			this.addTextBlock(displayIndex);
			//small image on the button "previous work"
			this.addPrewImg(prewIndex);
			//small image on the button "next work"
			this.addNextImg(nextIndex);
		},
		toggleIndexes: function toggleIndexes(arr, type) {
			var max = this.works.length - 1;

			for (var i = 0; i < arr.length; i++) {
				switch (type) {
					case "plus":
						if (arr[i] == max) arr[i] = 0;else arr[i]++;
						break;
					case "minus":
						if (arr[i] == 0) arr[i] = max;else arr[i]--;
						break;
				}
			}
		},
		animate: function animate(options) {
			var start = performance.now();

			requestAnimationFrame(function animate(time) {
				// timeFraction от 0 до 1
				var timeFraction = (time - start) / options.duration;
				if (timeFraction > 1) timeFraction = 1;

				// текущее состояние анимации
				var progress = timeFraction;
				//функция, описывающая анимацию
				options.draw(progress);

				if (timeFraction < 1) {
					requestAnimationFrame(animate);
				}
			});
		},
		addAnimate: function addAnimate(i, j, k) {
			//анимация до переключения слайда
			Slider.animate({
				duration: Slider.duration,
				draw: function draw(progress) {
					Slider.btnPrewImg.style.marginTop = progress * 600 + "px";
					Slider.btnNextImg.style.marginTop = progress * -600 + "px";
					Slider.display.style.opacity = 1 - progress;
				}
			});

			setTimeout(function () {
				Slider.clicking(i, j, k);

				Slider.btnPrewImg.style.marginTop = 0 + "px";
				Slider.btnPrewImg.style.height = 0 + "%";
				Slider.btnNextImg.style.marginTop = 0 + "px";
				Slider.btnNextImg.style.height = 0 + "%";

				//анимация после переключения слайда
				Slider.animate({
					duration: Slider.duration,
					draw: function draw(progress) {
						Slider.btnPrewImg.style.height = progress * 100 + "%";
						Slider.btnNextImg.style.height = progress * 100 + "%";
						Slider.display.style.opacity = progress;
					}
				});
			}, Slider.duration + 100);
		}
	};
});

//Login
(function () {
	document.addEventListener("DOMContentLoaded", function () {
		var loginForm = document.querySelector("#loginForm");

		if (loginForm) {
			loginForm.addEventListener("submit", login);
		}

		function login(e) {
			e.preventDefault();
			var data = {
				login: loginForm.login.value,
				password: loginForm.password.value
			};

			prepareSend("/login", loginForm, data, function (data) {
				if (data === "Авторизация успешна!") {
					location.href = "/admin";
				}
			});
		}
	});
})();

//prepareSend
var prepareSend = function prepareSend(url, form, data, cb) {
	var resultContainer = form.querySelector('.status');
	resultContainer.innerHTML = 'Sending...';
	sendAjax(url, data, function (data) {
		form.reset();
		resultContainer.innerHTML = data;
		if (cb) {
			cb(data);
		}
	});
};

//Ajax
var sendAjax = function sendAjax(url, data, cb) {
	var xhr = new XMLHttpRequest();
	xhr.open('POST', url, true);
	xhr.setRequestHeader('Content-Type', 'application/json');
	xhr.onload = function (e) {
		var result = void 0;
		try {
			result = JSON.parse(xhr.responseText);
		} catch (e) {
			cb('Извините в данных ошибка');
		}
		cb(result.status);
	};
	xhr.send(JSON.stringify(data));
};
//# sourceMappingURL=data:application/json;charset=utf8;base64,eyJ2ZXJzaW9uIjozLCJzb3VyY2VzIjpbImFwcC5qcyIsImZsaXAuanMiLCJwYXJhbGxheC5qcyIsIm1haW5tZW51LmpzIiwicHJlbG9hZGVyLmpzIiwic2lkZWJhci5qcyIsInNsaWRlci5qcyIsImxvZ2luLmpzIl0sIm5hbWVzIjpbInN2ZzRldmVyeWJvZHkiLCJmb3JFbGVtZW50IiwiZWxlbWVudCIsIlByb21pc2UiLCJyZXNvbHZlIiwiaXNNb2JpbGUiLCJBbmRyb2lkIiwibmF2aWdhdG9yIiwidXNlckFnZW50IiwibWF0Y2giLCJCbGFja0JlcnJ5IiwiaU9TIiwiT3BlcmEiLCJXaW5kb3dzIiwiYW55IiwiZG9jdW1lbnQiLCJhZGRFdmVudExpc3RlbmVyIiwiYXV0aG9yaXplIiwiZ2V0RWxlbWVudEJ5SWQiLCJmbGlwQ2xhc3MiLCJydW5GbGlwIiwiYm9keSIsImUiLCJ3aW5kb3ciLCJldmVudCIsImVsZW1zIiwicGF0aCIsImZsYWciLCJpIiwibGVuZ3RoIiwiaWQiLCJjbGFzc0xpc3QiLCJyZW1vdmUiLCJlbGVtIiwiZGF0YXNldCIsImZsaXBJZCIsImNsYXNzZXMiLCJjb250YWlucyIsImFkZCIsImxheWVycyIsImdldEVsZW1lbnRzQnlDbGFzc05hbWUiLCJwYXJhbGxheCIsIndyYXBwZXIiLCJub1BhcmFsbGF4IiwiY3JlYXRlRWxlbWVudCIsIm1vdmVMYWVycyIsImluaXRpYWxYIiwiaW5uZXJXaWR0aCIsInBhZ2VYIiwiaW5pdGlhbFkiLCJpbm5lckhlaWdodCIsInBhZ2VZIiwiZGl2aWRlciIsIlgiLCJZIiwidHJhbnNmb3JtU3R5bGUiLCJzdHlsZSIsInRyYW5zZm9ybSIsInJlbW92ZUNoaWxkIiwiY2xhc3NOYW1lIiwiaW5zZXJ0QmVmb3JlIiwiJCIsIm9uIiwidG9nZ2xlQ2xhc3MiLCJwcmVsb2FkZXIiLCJwZXJjZW50cyIsImltZ1BhdGgiLCJtYXAiLCJlbCIsImJnIiwiY3NzIiwiaW1nIiwiaXMiLCJyZXBsYWNlIiwiYXR0ciIsInNldFBlcmNlbnRzIiwidG90YWwiLCJjdXJyZW50IiwicGVyc2VudHMiLCJNYXRoIiwiY2VpbCIsInRleHQiLCJmYWRlT3V0IiwibG9hZEltYWdlcyIsImltYWdlcyIsImZvckVhY2giLCJmYWtlSW1hZ2UiLCJzcmMiLCJpbml0IiwiaW1ncyIsInRvQXJyYXkiLCJibG9nIiwidGhlbiIsInNjcm9sbFNpZGViYXIiLCJzaWRlYmFyIiwibWVudSIsImxpbmsiLCJhcnRpY2xlIiwiaXNQb3NpdGlvbkFydGljbGUiLCJvZmZzZXRIZWlnaHQiLCJvZmZzZXRUb3AiLCJwb3NpdGlvbkFydGljbGUiLCJ0b3AiLCJlcSIsIm9mZnNldCIsImJvdHRvbSIsIm1lbnVGaXhlZCIsInNjcm9sbCIsInBhZ2VZT2Zmc2V0IiwicmVtb3ZlQ2xhc3MiLCJhZGRDbGFzcyIsInNjcm9sbFBhZ2UiLCJzaWJsaW5ncyIsImNsaWNrT25NZW51IiwiaW5kZXgiLCJ0YXJnZXQiLCJzZWN0aW9uT2Zmc2V0Iiwib2ZmIiwiYW5pbWF0ZSIsImFkZExpc3RlbmVyIiwic2xpZGVyIiwib25sb2FkIiwiU2xpZGVyIiwiZGlzcGxheSIsImhlYWRlciIsImRlc2NyaXB0aW9uIiwic2l0ZUxpbmsiLCJidG5QcmV3IiwiYnRuTmV4dCIsImJ0blByZXdJbWciLCJidG5OZXh0SW1nIiwid29ya3MiLCJkdXJhdGlvbiIsInRpbWluZyIsInRpbWVGcmFjdGlvbiIsImRyYXciLCJwcm9ncmVzcyIsImNvbnNvbGUiLCJsb2ciLCJvcGFjaXR5IiwiZGF0YSIsImRhdGFBcnJheSIsInB1c2giLCJjbGlja2luZyIsImNhdGNoIiwic3RhdHVzIiwiZXJyb3IiLCJpbmRleGVzIiwidG9nZ2xlSW5kZXhlcyIsImFkZEFuaW1hdGUiLCJ1cmwiLCJyZWplY3QiLCJ4aHIiLCJYTUxIdHRwUmVxdWVzdCIsIm9wZW4iLCJyZXNwb25zZVR5cGUiLCJzZW5kIiwib25yZWFkeXN0YXRlY2hhbmdlIiwicmVhZHlTdGF0ZSIsInJlc3BvbnNlIiwiYWRkVGV4dEJsb2NrIiwiaW5uZXJUZXh0IiwidGl0bGUiLCJkZXNjIiwiaHJlZiIsImFkZERpc3BsYXkiLCJpbWFnZSIsImFsdCIsImFkZE5leHRJbWciLCJwcmV2aWV3IiwiYWRkUHJld0ltZyIsImRpc3BsYXlJbmRleCIsInByZXdJbmRleCIsIm5leHRJbmRleCIsImFyciIsInR5cGUiLCJtYXgiLCJvcHRpb25zIiwic3RhcnQiLCJwZXJmb3JtYW5jZSIsIm5vdyIsInJlcXVlc3RBbmltYXRpb25GcmFtZSIsInRpbWUiLCJqIiwiayIsIm1hcmdpblRvcCIsInNldFRpbWVvdXQiLCJoZWlnaHQiLCJsb2dpbkZvcm0iLCJxdWVyeVNlbGVjdG9yIiwibG9naW4iLCJwcmV2ZW50RGVmYXVsdCIsInZhbHVlIiwicGFzc3dvcmQiLCJwcmVwYXJlU2VuZCIsImxvY2F0aW9uIiwiZm9ybSIsImNiIiwicmVzdWx0Q29udGFpbmVyIiwiaW5uZXJIVE1MIiwic2VuZEFqYXgiLCJyZXNldCIsInNldFJlcXVlc3RIZWFkZXIiLCJyZXN1bHQiLCJKU09OIiwicGFyc2UiLCJyZXNwb25zZVRleHQiLCJzdHJpbmdpZnkiXSwibWFwcGluZ3MiOiJBQUFBOztBQUVBLENBQUEsWUFBQTtBQUNBO0FBQ0FBO0FBQ0EsQ0FIQTs7QUFLQTtBQUNBLElBQUFDLGFBQUEsU0FBQUEsVUFBQSxDQUFBQyxPQUFBLEVBQUE7QUFDQSxRQUFBLElBQUFDLE9BQUEsQ0FBQSxVQUFBQyxPQUFBLEVBQUE7QUFDQSxNQUFBRixPQUFBLEVBQUE7QUFDQUU7QUFDQTtBQUNBLEVBSkEsQ0FBQTtBQUtBLENBTkE7O0FBUUE7QUFDQSxJQUFBQyxXQUFBO0FBQ0FDLFVBQUEsbUJBQUE7QUFBQSxTQUFBQyxVQUFBQyxTQUFBLENBQUFDLEtBQUEsQ0FBQSxVQUFBLENBQUE7QUFBQSxFQURBO0FBRUFDLGFBQUEsc0JBQUE7QUFBQSxTQUFBSCxVQUFBQyxTQUFBLENBQUFDLEtBQUEsQ0FBQSxhQUFBLENBQUE7QUFBQSxFQUZBO0FBR0FFLE1BQUEsZUFBQTtBQUFBLFNBQUFKLFVBQUFDLFNBQUEsQ0FBQUMsS0FBQSxDQUFBLG1CQUFBLENBQUE7QUFBQSxFQUhBO0FBSUFHLFFBQUEsaUJBQUE7QUFBQSxTQUFBTCxVQUFBQyxTQUFBLENBQUFDLEtBQUEsQ0FBQSxhQUFBLENBQUE7QUFBQSxFQUpBO0FBS0FJLFVBQUEsbUJBQUE7QUFBQSxTQUFBTixVQUFBQyxTQUFBLENBQUFDLEtBQUEsQ0FBQSxXQUFBLENBQUE7QUFBQSxFQUxBOztBQU9BSyxNQUFBLGVBQUE7QUFDQSxTQUFBVCxTQUFBQyxPQUFBLE1BQUFELFNBQUFLLFVBQUEsRUFBQSxJQUFBTCxTQUFBTSxHQUFBLEVBQUEsSUFBQU4sU0FBQU8sS0FBQSxFQUFBLElBQUFQLFNBQUFRLE9BQUEsRUFBQTtBQUNBO0FBVEEsQ0FBQTtBQ2pCQTtBQUNBLENBQUEsWUFBQTtBQUNBRSxVQUFBQyxnQkFBQSxDQUFBLGtCQUFBLEVBQUEsWUFBQTs7QUFFQSxNQUFBQyxZQUFBRixTQUFBRyxjQUFBLENBQUEsV0FBQSxDQUFBO0FBQUEsTUFDQUMsWUFBQSxTQURBOztBQUdBO0FBQ0EsTUFBQUYsU0FBQSxFQUFBO0FBQ0FBLGFBQUFELGdCQUFBLENBQUEsT0FBQSxFQUFBSSxPQUFBOztBQUVBO0FBQ0FMLFlBQUFNLElBQUEsQ0FBQUwsZ0JBQUEsQ0FBQSxPQUFBLEVBQUEsVUFBQU0sQ0FBQSxFQUFBO0FBQ0EsUUFBQSxDQUFBQSxDQUFBLEVBQUFBLElBQUFDLE9BQUFDLEtBQUE7QUFDQSxRQUFBQyxRQUFBSCxFQUFBSSxJQUFBO0FBQUEsUUFDQUMsT0FBQSxJQURBOztBQUdBLFNBQUEsSUFBQUMsSUFBQSxDQUFBLEVBQUFBLElBQUFILE1BQUFJLE1BQUEsRUFBQUQsR0FBQSxFQUFBO0FBQ0EsU0FBQUgsTUFBQUcsQ0FBQSxFQUFBRSxFQUFBLEtBQUEsV0FBQSxJQUFBTCxNQUFBRyxDQUFBLEVBQUFFLEVBQUEsS0FBQSxPQUFBLEVBQUE7QUFDQUgsYUFBQSxLQUFBO0FBQ0E7QUFDQTs7QUFFQSxRQUFBQSxJQUFBLEVBQUFaLFNBQUFHLGNBQUEsQ0FBQSxPQUFBLEVBQUFhLFNBQUEsQ0FBQUMsTUFBQSxDQUFBYixTQUFBO0FBQ0EsSUFaQTtBQWFBOztBQUdBO0FBQ0EsV0FBQUMsT0FBQSxHQUFBO0FBQ0EsT0FBQWEsT0FBQWxCLFNBQUFHLGNBQUEsQ0FBQSxLQUFBZ0IsT0FBQSxDQUFBQyxNQUFBLENBQUE7QUFBQSxPQUNBQyxVQUFBSCxLQUFBRixTQURBOztBQUdBSyxXQUFBQyxRQUFBLENBQUFsQixTQUFBLE1BQUEsSUFBQSxHQUFBaUIsUUFBQUosTUFBQSxDQUFBYixTQUFBLENBQUEsR0FBQWlCLFFBQUFFLEdBQUEsQ0FBQW5CLFNBQUEsQ0FBQTtBQUNBO0FBQ0EsRUFqQ0E7QUFrQ0EsQ0FuQ0E7O0FDREE7QUFDQSxDQUFBLFlBQUE7QUFDQUosVUFBQUMsZ0JBQUEsQ0FBQSxrQkFBQSxFQUFBLFlBQUE7QUFDQSxNQUFBdUIsU0FBQXhCLFNBQUF5QixzQkFBQSxDQUFBLGlCQUFBLENBQUE7QUFBQSxNQUNBQyxXQUFBMUIsU0FBQUcsY0FBQSxDQUFBLFVBQUEsQ0FEQTtBQUFBLE1BRUF3QixVQUFBM0IsU0FBQXlCLHNCQUFBLENBQUEsU0FBQSxFQUFBLENBQUEsQ0FGQTtBQUFBLE1BR0FHLGFBQUE1QixTQUFBNkIsYUFBQSxDQUFBLEtBQUEsQ0FIQTs7QUFLQSxNQUFBQyxZQUFBLFNBQUFBLFNBQUEsQ0FBQXZCLENBQUEsRUFBQTtBQUNBQSxPQUFBQSxLQUFBRSxLQUFBOztBQUVBLE9BQUFzQixXQUFBdkIsT0FBQXdCLFVBQUEsR0FBQSxDQUFBLEdBQUF6QixFQUFBMEIsS0FBQTtBQUFBLE9BQ0FDLFdBQUExQixPQUFBMkIsV0FBQSxHQUFBLENBQUEsR0FBQTVCLEVBQUE2QixLQURBOztBQUdBLFFBQUEsSUFBQXZCLElBQUEsQ0FBQSxFQUFBQSxJQUFBVyxPQUFBVixNQUFBLEVBQUFELEdBQUEsRUFBQTtBQUNBLFFBQUF3QixnQkFBQTs7QUFFQSxRQUFBYixPQUFBVixNQUFBLElBQUEsQ0FBQSxFQUFBdUIsVUFBQXhCLElBQUEsR0FBQSxDQUFBLEtBQ0F3QixVQUFBLENBQUF4QixJQUFBLENBQUEsSUFBQSxHQUFBOztBQUVBLFFBQUF5QixJQUFBUCxXQUFBTSxPQUFBO0FBQUEsUUFDQUUsSUFBQUwsV0FBQUcsT0FEQTtBQUFBLFFBRUFHLGlCQUFBLGlCQUFBRixDQUFBLEdBQUEsTUFBQSxHQUFBQyxDQUFBLEdBQUEsTUFBQSxHQUFBLElBRkE7O0FBSUFmLFdBQUFYLENBQUEsRUFBQTRCLEtBQUEsQ0FBQUMsU0FBQSxHQUFBRixjQUFBO0FBQ0E7QUFDQSxHQWxCQTs7QUFvQkEsTUFBQWxELFNBQUFTLEdBQUEsRUFBQSxFQUFBO0FBQ0E0QixXQUFBZ0IsV0FBQSxDQUFBakIsUUFBQTtBQUNBRSxjQUFBZ0IsU0FBQSxHQUFBLDJCQUFBO0FBQ0FqQixXQUFBa0IsWUFBQSxDQUFBakIsVUFBQSxFQUFBNUIsU0FBQXlCLHNCQUFBLENBQUEsUUFBQSxFQUFBLENBQUEsQ0FBQTtBQUVBLEdBTEEsTUFLQTtBQUNBakIsVUFBQVAsZ0JBQUEsQ0FBQSxXQUFBLEVBQUE2QixTQUFBO0FBQ0E7QUFDQSxFQWxDQTtBQW1DQSxDQXBDQTs7QUNEQTtBQUNBO0FBQ0FnQixFQUFBLFlBQUE7QUFDQUEsR0FBQSxTQUFBLEVBQUFDLEVBQUEsQ0FBQSxPQUFBLEVBQUEsWUFBQTtBQUNBRCxJQUFBLElBQUEsRUFBQUUsV0FBQSxDQUFBLGNBQUE7QUFDQUYsSUFBQSxZQUFBLEVBQUFFLFdBQUEsQ0FBQSxrQkFBQTtBQUNBLEVBSEE7QUFJQSxDQUxBOztBQ0ZBO0FBQ0E7QUFDQSxJQUFBQyxZQUFBLFlBQUE7QUFDQSxLQUFBQyxXQUFBLENBQUE7QUFBQSxLQUNBRCxZQUFBSCxFQUFBLFlBQUEsQ0FEQTs7QUFHQSxLQUFBSyxVQUFBTCxFQUFBLEdBQUEsRUFBQU0sR0FBQSxDQUFBLFVBQUF2QyxDQUFBLEVBQUF3QyxFQUFBLEVBQUE7QUFDQSxNQUFBQyxLQUFBUixFQUFBTyxFQUFBLEVBQUFFLEdBQUEsQ0FBQSxrQkFBQSxDQUFBO0FBQUEsTUFDQUMsTUFBQVYsRUFBQU8sRUFBQSxFQUFBSSxFQUFBLENBQUEsS0FBQSxDQURBO0FBQUEsTUFFQTlDLE9BQUEsRUFGQTs7QUFJQSxNQUFBMkMsTUFBQSxNQUFBLEVBQUE7QUFDQTNDLFVBQUEyQyxHQUFBSSxPQUFBLENBQUEsT0FBQSxFQUFBLEVBQUEsRUFBQUEsT0FBQSxDQUFBLElBQUEsRUFBQSxFQUFBLENBQUEsQ0FBQTtBQUNBOztBQUVBLE1BQUFGLEdBQUEsRUFBQTtBQUNBN0MsVUFBQW1DLEVBQUFPLEVBQUEsRUFBQU0sSUFBQSxDQUFBLEtBQUEsQ0FBQTtBQUNBOztBQUVBLE1BQUFoRCxJQUFBLEVBQUEsT0FBQUEsSUFBQTtBQUNBLEVBZEEsQ0FBQTs7QUFnQkEsS0FBQWlELGNBQUEsU0FBQUEsV0FBQSxDQUFBQyxLQUFBLEVBQUFDLE9BQUEsRUFBQTtBQUNBLE1BQUFDLFdBQUFDLEtBQUFDLElBQUEsQ0FBQUgsVUFBQUQsS0FBQSxHQUFBLEdBQUEsQ0FBQTs7QUFFQWYsSUFBQSxXQUFBLEVBQUFvQixJQUFBLENBQUFILFFBQUE7O0FBRUEsTUFBQUEsWUFBQSxHQUFBLEVBQUE7QUFDQWQsYUFBQWtCLE9BQUE7QUFDQTtBQUNBLEVBUkE7O0FBVUEsS0FBQUMsYUFBQSxTQUFBQSxVQUFBLENBQUFDLE1BQUEsRUFBQTs7QUFFQSxNQUFBLENBQUFBLE9BQUF2RCxNQUFBLEVBQUFtQyxVQUFBa0IsT0FBQTs7QUFFQUUsU0FBQUMsT0FBQSxDQUFBLFVBQUFkLEdBQUEsRUFBQTNDLENBQUEsRUFBQXdELE1BQUEsRUFBQTtBQUNBLE9BQUFFLFlBQUF6QixFQUFBLE9BQUEsRUFBQTtBQUNBYSxVQUFBO0FBQ0FhLFVBQUFoQjtBQURBO0FBREEsSUFBQSxDQUFBOztBQU1BZSxhQUFBeEIsRUFBQSxDQUFBLFlBQUEsRUFBQSxZQUFBO0FBQ0FHO0FBQ0FVLGdCQUFBUyxPQUFBdkQsTUFBQSxFQUFBb0MsUUFBQTtBQUNBLElBSEE7QUFJQSxHQVhBO0FBWUEsRUFoQkE7O0FBa0JBLFFBQUE7QUFDQXVCLFFBQUEsZ0JBQUE7QUFDQSxPQUFBQyxPQUFBdkIsUUFBQXdCLE9BQUEsRUFBQTs7QUFFQVAsY0FBQU0sSUFBQTtBQUNBO0FBTEEsRUFBQTtBQU9BLENBdkRBLEVBQUE7O0FBMERBNUIsRUFBQSxZQUFBO0FBQ0FHLFdBQUF3QixJQUFBO0FBQ0EsQ0FGQTs7QUM1REE7QUFDQTtBQUNBLElBQUFHLE9BQUE1RSxTQUFBRyxjQUFBLENBQUEsTUFBQSxDQUFBOztBQUVBO0FBQ0FqQixXQUFBMEYsSUFBQSxFQUFBQyxJQUFBLENBQUEsWUFBQTtBQUNBO0FBQ0EsS0FBQUMsZ0JBQUEsWUFBQTtBQUNBLE1BQUFDLFVBQUFqQyxFQUFBLFVBQUEsQ0FBQTtBQUFBLE1BQ0FrQyxPQUFBbEMsRUFBQSxjQUFBLENBREE7QUFBQSxNQUVBbUMsT0FBQW5DLEVBQUEsZ0JBQUEsQ0FGQTtBQUFBLE1BR0FvQyxVQUFBcEMsRUFBQSxVQUFBLENBSEE7QUFBQSxNQUlBeEMsT0FBQU4sU0FBQU0sSUFKQTtBQUFBLE1BS0E2RSxvQkFBQSxFQUxBO0FBQUEsTUFNQUMsZUFBQXRDLEVBQUEsZ0JBQUEsRUFBQSxDQUFBLEVBQUF1QyxTQUFBLEdBQUF2QyxFQUFBLE9BQUEsRUFBQSxDQUFBLEVBQUF1QyxTQU5BOztBQVFBLE1BQUFDLGtCQUFBLFNBQUFBLGVBQUEsQ0FBQWpDLEVBQUEsRUFBQTtBQUNBLFFBQUEsSUFBQXhDLElBQUEsQ0FBQSxFQUFBQSxJQUFBd0MsR0FBQXZDLE1BQUEsRUFBQUQsR0FBQSxFQUFBO0FBQ0FzRSxzQkFBQXRFLENBQUEsSUFBQSxFQUFBO0FBQ0FzRSxzQkFBQXRFLENBQUEsRUFBQTBFLEdBQUEsR0FBQWxDLEdBQ0FtQyxFQURBLENBQ0EzRSxDQURBLEVBRUE0RSxNQUZBLEdBR0FGLEdBSEEsR0FHQUgsWUFIQTtBQUlBRCxzQkFBQXRFLENBQUEsRUFBQTZFLE1BQUEsR0FBQVAsa0JBQUF0RSxDQUFBLEVBQUEwRSxHQUFBLEdBQUFsQyxHQUNBbUMsRUFEQSxDQUNBM0UsQ0FEQSxFQUVBc0IsV0FGQSxFQUFBO0FBR0E7QUFDQSxHQVhBOztBQWFBLE1BQUF3RCxZQUFBLFNBQUFBLFNBQUEsR0FBQTtBQUNBLE9BQUFDLFNBQUFwRixPQUFBcUYsV0FBQTs7QUFFQSxPQUFBRCxTQUFBVixRQUFBTyxNQUFBLEdBQUFGLEdBQUEsRUFBQTtBQUNBUixZQUFBZSxXQUFBLENBQUEsT0FBQTtBQUNBaEQsTUFBQSxnQkFBQSxFQUFBZ0QsV0FBQSxDQUFBLFdBQUE7QUFDQSxJQUhBLE1BSUE7QUFDQWYsWUFBQWdCLFFBQUEsQ0FBQSxPQUFBO0FBQ0FqRCxNQUFBLGdCQUFBLEVBQUFpRCxRQUFBLENBQUEsV0FBQTtBQUNBO0FBQ0EsR0FYQTs7QUFhQSxNQUFBQyxhQUFBLFNBQUFBLFVBQUEsQ0FBQXpGLENBQUEsRUFBQTtBQUNBLE9BQUFxRixTQUFBcEYsT0FBQXFGLFdBQUE7O0FBRUEsUUFBQSxJQUFBaEYsSUFBQSxDQUFBLEVBQUFBLElBQUFzRSxrQkFBQXJFLE1BQUEsRUFBQUQsR0FBQSxFQUFBO0FBQ0EsUUFBQStFLFVBQUFULGtCQUFBdEUsQ0FBQSxFQUFBMEUsR0FBQSxJQUFBSyxVQUFBVCxrQkFBQXRFLENBQUEsRUFBQTZFLE1BQUEsRUFBQTtBQUNBVCxVQUNBTyxFQURBLENBQ0EzRSxDQURBLEVBRUFrRixRQUZBLENBRUEsc0JBRkEsRUFHQUUsUUFIQSxHQUlBSCxXQUpBLENBSUEsc0JBSkE7QUFLQTtBQUNBO0FBQ0EsR0FaQTs7QUFjQSxNQUFBSSxjQUFBLFNBQUFBLFdBQUEsQ0FBQTNGLENBQUEsRUFBQTtBQUNBLE9BQUE0RixRQUFBckQsRUFBQXZDLEVBQUE2RixNQUFBLEVBQUFELEtBQUEsRUFBQTtBQUNBLE9BQUFFLGdCQUFBbkIsUUFDQU0sRUFEQSxDQUNBVyxLQURBLEVBRUFWLE1BRkEsR0FHQUYsR0FIQTtBQUlBekMsS0FBQTlDLFFBQUEsRUFBQXNHLEdBQUEsQ0FBQSxRQUFBLEVBQUFOLFVBQUE7QUFDQWxELEtBQUEsWUFBQSxFQUFBeUQsT0FBQSxDQUFBO0FBQ0EsaUJBQUFGO0FBREEsSUFBQSxFQUVBLFlBQUE7QUFDQXZELE1BQUF2QyxFQUFBNkYsTUFBQSxFQUNBTCxRQURBLENBQ0Esc0JBREEsRUFFQUUsUUFGQSxHQUdBSCxXQUhBLENBR0Esc0JBSEE7QUFJQWhELE1BQUE5QyxRQUFBLEVBQUErQyxFQUFBLENBQUEsUUFBQSxFQUFBaUQsVUFBQTtBQUNBLElBUkE7QUFTQSxHQWhCQTs7QUFrQkEsTUFBQVEsY0FBQSxTQUFBQSxXQUFBLEdBQUE7QUFDQTFELEtBQUFrQyxJQUFBLEVBQUFqQyxFQUFBLENBQUEsT0FBQSxFQUFBbUQsV0FBQTs7QUFFQXBELEtBQUE5QyxRQUFBLEVBQUErQyxFQUFBLENBQUEsUUFBQSxFQUFBaUQsVUFBQTtBQUNBbEQsS0FBQTlDLFFBQUEsRUFBQStDLEVBQUEsQ0FBQSxRQUFBLEVBQUE0QyxTQUFBOztBQUVBN0MsS0FBQXRDLE1BQUEsRUFBQXVDLEVBQUEsQ0FBQSxNQUFBLEVBQUEsVUFBQXhDLENBQUEsRUFBQTtBQUNBK0Usb0JBQUFKLE9BQUE7QUFDQSxJQUZBOztBQUlBcEMsS0FBQXRDLE1BQUEsRUFBQXVDLEVBQUEsQ0FBQSxRQUFBLEVBQUEsVUFBQXhDLENBQUEsRUFBQTtBQUNBK0Usb0JBQUFKLE9BQUE7QUFDQSxJQUZBO0FBR0EsR0FiQTs7QUFlQSxTQUFBO0FBQ0FULFNBQUErQjtBQURBLEdBQUE7QUFHQSxFQXJGQSxFQUFBOztBQXVGQTFCLGVBQUFMLElBQUE7O0FBRUE7QUFDQTNCLEdBQUEsTUFBQSxFQUFBQyxFQUFBLENBQUEsT0FBQSxFQUFBLFlBQUE7QUFDQUQsSUFBQSxPQUFBLEVBQUFFLFdBQUEsQ0FBQSxJQUFBO0FBQ0EsRUFGQTtBQUdBLENBL0ZBOztBQ0xBO0FBQ0EsSUFBQXlELFNBQUF6RyxTQUFBRyxjQUFBLENBQUEsUUFBQSxDQUFBOztBQUVBakIsV0FBQXVILE1BQUEsRUFBQTVCLElBQUEsQ0FBQSxZQUFBO0FBQ0FyRSxRQUFBa0csTUFBQSxHQUFBLFlBQUE7QUFDQUMsU0FBQWxDLElBQUE7QUFDQSxFQUZBOztBQUlBLEtBQUFrQyxTQUFBO0FBQ0FsQyxNQURBLGtCQUNBO0FBQ0EsUUFBQW1DLE9BQUEsR0FBQTVHLFNBQUFHLGNBQUEsQ0FBQSxTQUFBLENBQUE7QUFDQSxRQUFBMEcsTUFBQSxHQUFBN0csU0FBQUcsY0FBQSxDQUFBLFFBQUEsQ0FBQTtBQUNBLFFBQUEyRyxXQUFBLEdBQUE5RyxTQUFBRyxjQUFBLENBQUEsYUFBQSxDQUFBO0FBQ0EsUUFBQTRHLFFBQUEsR0FBQS9HLFNBQUFHLGNBQUEsQ0FBQSxVQUFBLENBQUE7QUFDQSxRQUFBNkcsT0FBQSxHQUFBaEgsU0FBQUcsY0FBQSxDQUFBLFNBQUEsQ0FBQTtBQUNBLFFBQUE4RyxPQUFBLEdBQUFqSCxTQUFBRyxjQUFBLENBQUEsU0FBQSxDQUFBO0FBQ0EsUUFBQStHLFVBQUEsR0FBQWxILFNBQUFHLGNBQUEsQ0FBQSxZQUFBLENBQUE7QUFDQSxRQUFBZ0gsVUFBQSxHQUFBbkgsU0FBQUcsY0FBQSxDQUFBLFlBQUEsQ0FBQTs7QUFFQSxRQUFBaUgsS0FBQSxHQUFBLEVBQUE7O0FBRUEsUUFBQUMsUUFBQSxHQUFBLElBQUE7O0FBRUEsUUFBQVQsT0FBQSxDQUFBM0csZ0JBQUEsQ0FBQSxPQUFBLEVBQUEsWUFBQTtBQUNBMEcsV0FBQUosT0FBQSxDQUFBO0FBQ0FjLGVBQUEsSUFEQTtBQUVBQyxhQUFBLGdCQUFBQyxZQUFBLEVBQUE7QUFBQSxhQUFBQSxZQUFBO0FBQUEsTUFGQTtBQUdBQyxXQUFBLGNBQUFDLFFBQUEsRUFBQTtBQUNBQyxjQUFBQyxHQUFBLENBQUFGLFFBQUE7QUFDQWQsYUFBQUMsT0FBQSxDQUFBbkUsS0FBQSxDQUFBbUYsT0FBQSxHQUFBSCxRQUFBO0FBQ0E7QUFOQSxLQUFBO0FBUUEsSUFUQTs7QUFXQTtBQUNBLFFBQUFJLElBQUEsQ0FBQSwwQkFBQSxFQUNBaEQsSUFEQSxDQUNBLFVBQUFpRCxTQUFBLEVBQUE7QUFDQSxTQUFBLElBQUFqSCxJQUFBLENBQUEsRUFBQUEsSUFBQWlILFVBQUFoSCxNQUFBLEVBQUFELEdBQUEsRUFBQTtBQUNBOEYsWUFBQVMsS0FBQSxDQUFBVyxJQUFBLENBQUFELFVBQUFqSCxDQUFBLENBQUE7QUFDQThGLFlBQUFTLEtBQUEsQ0FBQXZHLENBQUEsRUFBQXNGLEtBQUEsR0FBQXRGLENBQUE7QUFDQTtBQUNBO0FBQ0E4RixXQUFBcUIsUUFBQSxDQUFBLENBQUEsRUFBQUYsVUFBQWhILE1BQUEsR0FBQSxDQUFBLEVBQUEsQ0FBQTtBQUNBLElBUkEsRUFTQW1ILEtBVEEsQ0FTQSxVQUFBQyxNQUFBLEVBQUE7QUFDQVIsWUFBQVMsS0FBQSxDQUFBLGNBQUEsRUFBQUQsTUFBQTtBQUNBLElBWEE7O0FBY0E7QUFDQSxRQUFBbEIsT0FBQSxDQUFBL0csZ0JBQUEsQ0FBQSxPQUFBLEVBQUEsVUFBQVEsS0FBQSxFQUFBO0FBQ0EsUUFBQTJILFVBQUEsQ0FDQXpCLE9BQUFDLE9BQUEsQ0FBQXpGLE9BQUEsQ0FBQWdGLEtBREEsRUFFQVEsT0FBQU8sVUFBQSxDQUFBL0YsT0FBQSxDQUFBZ0YsS0FGQSxFQUdBUSxPQUFBUSxVQUFBLENBQUFoRyxPQUFBLENBQUFnRixLQUhBLENBQUE7O0FBTUFRLFdBQUEwQixhQUFBLENBQUFELE9BQUEsRUFBQSxPQUFBO0FBQ0F6QixXQUFBMkIsVUFBQSxDQUFBRixRQUFBLENBQUEsQ0FBQSxFQUFBQSxRQUFBLENBQUEsQ0FBQSxFQUFBQSxRQUFBLENBQUEsQ0FBQTtBQUNBLElBVEE7O0FBV0EsUUFBQW5CLE9BQUEsQ0FBQWhILGdCQUFBLENBQUEsT0FBQSxFQUFBLFlBQUE7QUFDQSxRQUFBbUksVUFBQSxDQUNBekIsT0FBQUMsT0FBQSxDQUFBekYsT0FBQSxDQUFBZ0YsS0FEQSxFQUVBUSxPQUFBTyxVQUFBLENBQUEvRixPQUFBLENBQUFnRixLQUZBLEVBR0FRLE9BQUFRLFVBQUEsQ0FBQWhHLE9BQUEsQ0FBQWdGLEtBSEEsQ0FBQTs7QUFNQVEsV0FBQTBCLGFBQUEsQ0FBQUQsT0FBQSxFQUFBLE1BQUE7QUFDQXpCLFdBQUEyQixVQUFBLENBQUFGLFFBQUEsQ0FBQSxDQUFBLEVBQUFBLFFBQUEsQ0FBQSxDQUFBLEVBQUFBLFFBQUEsQ0FBQSxDQUFBO0FBQ0EsSUFUQTtBQVVBLEdBL0RBO0FBaUVBUCxNQWpFQSxnQkFpRUFVLEdBakVBLEVBaUVBO0FBQ0EsVUFBQSxJQUFBbkosT0FBQSxDQUFBLFVBQUFDLE9BQUEsRUFBQW1KLE1BQUEsRUFBQTtBQUNBLFFBQUFDLE1BQUEsSUFBQUMsY0FBQSxFQUFBO0FBQ0FELFFBQUFFLElBQUEsQ0FBQSxLQUFBLEVBQUFKLEdBQUEsRUFBQSxJQUFBO0FBQ0FFLFFBQUFHLFlBQUEsR0FBQSxNQUFBO0FBQ0FILFFBQUFJLElBQUE7QUFDQUosUUFBQUssa0JBQUEsR0FBQSxZQUFBO0FBQ0EsU0FBQUwsSUFBQU0sVUFBQSxLQUFBLENBQUEsRUFBQTtBQUNBLFNBQUFOLElBQUFQLE1BQUEsS0FBQSxHQUFBLEVBQUE7QUFDQU0sYUFBQUMsSUFBQVAsTUFBQTtBQUNBLE1BRkEsTUFFQTtBQUNBN0ksY0FBQW9KLElBQUFPLFFBQUE7QUFDQTtBQUNBLEtBUEE7QUFRQSxJQWJBLENBQUE7QUFjQSxHQWhGQTtBQWtGQUMsY0FsRkEsd0JBa0ZBOUMsS0FsRkEsRUFrRkE7QUFDQSxRQUFBVSxNQUFBLENBQUFxQyxTQUFBLEdBQUEsS0FBQTlCLEtBQUEsQ0FBQWpCLEtBQUEsRUFBQWdELEtBQUE7QUFDQSxRQUFBckMsV0FBQSxDQUFBb0MsU0FBQSxHQUFBLEtBQUE5QixLQUFBLENBQUFqQixLQUFBLEVBQUFpRCxJQUFBO0FBQ0EsUUFBQXJDLFFBQUEsQ0FBQXNDLElBQUEsR0FBQSxLQUFBakMsS0FBQSxDQUFBakIsS0FBQSxFQUFBbEIsSUFBQTtBQUNBLEdBdEZBO0FBd0ZBcUUsWUF4RkEsc0JBd0ZBbkQsS0F4RkEsRUF3RkE7QUFDQSxRQUFBUyxPQUFBLENBQUFwQyxHQUFBLEdBQUEsS0FBQTRDLEtBQUEsQ0FBQWpCLEtBQUEsRUFBQW9ELEtBQUE7QUFDQSxRQUFBM0MsT0FBQSxDQUFBNEMsR0FBQSxHQUFBLEtBQUFwQyxLQUFBLENBQUFqQixLQUFBLEVBQUFnRCxLQUFBO0FBQ0EsUUFBQXZDLE9BQUEsQ0FBQXpGLE9BQUEsQ0FBQWdGLEtBQUEsR0FBQUEsS0FBQTtBQUNBLEdBNUZBO0FBOEZBc0QsWUE5RkEsc0JBOEZBdEQsS0E5RkEsRUE4RkE7QUFDQSxRQUFBZ0IsVUFBQSxDQUFBM0MsR0FBQSxHQUFBLEtBQUE0QyxLQUFBLENBQUFqQixLQUFBLEVBQUF1RCxPQUFBO0FBQ0EsUUFBQXZDLFVBQUEsQ0FBQXFDLEdBQUEsR0FBQSxLQUFBcEMsS0FBQSxDQUFBakIsS0FBQSxFQUFBZ0QsS0FBQTtBQUNBLFFBQUFoQyxVQUFBLENBQUFoRyxPQUFBLENBQUFnRixLQUFBLEdBQUFBLEtBQUE7QUFDQSxHQWxHQTtBQW9HQXdELFlBcEdBLHNCQW9HQXhELEtBcEdBLEVBb0dBO0FBQ0EsUUFBQWUsVUFBQSxDQUFBMUMsR0FBQSxHQUFBLEtBQUE0QyxLQUFBLENBQUFqQixLQUFBLEVBQUF1RCxPQUFBO0FBQ0EsUUFBQXhDLFVBQUEsQ0FBQXNDLEdBQUEsR0FBQSxLQUFBcEMsS0FBQSxDQUFBakIsS0FBQSxFQUFBZ0QsS0FBQTtBQUNBLFFBQUFqQyxVQUFBLENBQUEvRixPQUFBLENBQUFnRixLQUFBLEdBQUFBLEtBQUE7QUFDQSxHQXhHQTtBQTBHQTZCLFVBMUdBLG9CQTBHQTRCLFlBMUdBLEVBMEdBQyxTQTFHQSxFQTBHQUMsU0ExR0EsRUEwR0E7QUFDQTtBQUNBLFFBQUFSLFVBQUEsQ0FBQU0sWUFBQTtBQUNBLFFBQUFYLFlBQUEsQ0FBQVcsWUFBQTtBQUNBO0FBQ0EsUUFBQUQsVUFBQSxDQUFBRSxTQUFBO0FBQ0E7QUFDQSxRQUFBSixVQUFBLENBQUFLLFNBQUE7QUFDQSxHQWxIQTtBQW9IQXpCLGVBcEhBLHlCQW9IQTBCLEdBcEhBLEVBb0hBQyxJQXBIQSxFQW9IQTtBQUNBLE9BQUFDLE1BQUEsS0FBQTdDLEtBQUEsQ0FBQXRHLE1BQUEsR0FBQSxDQUFBOztBQUVBLFFBQUEsSUFBQUQsSUFBQSxDQUFBLEVBQUFBLElBQUFrSixJQUFBakosTUFBQSxFQUFBRCxHQUFBLEVBQUE7QUFDQSxZQUFBbUosSUFBQTtBQUNBLFVBQUEsTUFBQTtBQUNBLFVBQUFELElBQUFsSixDQUFBLEtBQUFvSixHQUFBLEVBQUFGLElBQUFsSixDQUFBLElBQUEsQ0FBQSxDQUFBLEtBQ0FrSixJQUFBbEosQ0FBQTtBQUNBO0FBQ0EsVUFBQSxPQUFBO0FBQ0EsVUFBQWtKLElBQUFsSixDQUFBLEtBQUEsQ0FBQSxFQUFBa0osSUFBQWxKLENBQUEsSUFBQW9KLEdBQUEsQ0FBQSxLQUNBRixJQUFBbEosQ0FBQTtBQUNBO0FBUkE7QUFVQTtBQUNBLEdBbklBO0FBcUlBMEYsU0FySUEsbUJBcUlBMkQsT0FySUEsRUFxSUE7QUFDQSxPQUFBQyxRQUFBQyxZQUFBQyxHQUFBLEVBQUE7O0FBRUFDLHlCQUFBLFNBQUEvRCxPQUFBLENBQUFnRSxJQUFBLEVBQUE7QUFDQTtBQUNBLFFBQUFoRCxlQUFBLENBQUFnRCxPQUFBSixLQUFBLElBQUFELFFBQUE3QyxRQUFBO0FBQ0EsUUFBQUUsZUFBQSxDQUFBLEVBQUFBLGVBQUEsQ0FBQTs7QUFFQTtBQUNBLFFBQUFFLFdBQUFGLFlBQUE7QUFDQTtBQUNBMkMsWUFBQTFDLElBQUEsQ0FBQUMsUUFBQTs7QUFFQSxRQUFBRixlQUFBLENBQUEsRUFBQTtBQUNBK0MsMkJBQUEvRCxPQUFBO0FBQ0E7QUFDQSxJQWJBO0FBY0EsR0F0SkE7QUF3SkErQixZQXhKQSxzQkF3SkF6SCxDQXhKQSxFQXdKQTJKLENBeEpBLEVBd0pBQyxDQXhKQSxFQXdKQTtBQUNBO0FBQ0E5RCxVQUFBSixPQUFBLENBQUE7QUFDQWMsY0FBQVYsT0FBQVUsUUFEQTtBQUVBRyxVQUFBLGNBQUFDLFFBQUEsRUFBQTtBQUNBZCxZQUFBTyxVQUFBLENBQUF6RSxLQUFBLENBQUFpSSxTQUFBLEdBQUFqRCxXQUFBLEdBQUEsR0FBQSxJQUFBO0FBQ0FkLFlBQUFRLFVBQUEsQ0FBQTFFLEtBQUEsQ0FBQWlJLFNBQUEsR0FBQWpELFdBQUEsQ0FBQSxHQUFBLEdBQUEsSUFBQTtBQUNBZCxZQUFBQyxPQUFBLENBQUFuRSxLQUFBLENBQUFtRixPQUFBLEdBQUEsSUFBQUgsUUFBQTtBQUNBO0FBTkEsSUFBQTs7QUFTQWtELGNBQUEsWUFBQTtBQUNBaEUsV0FBQXFCLFFBQUEsQ0FBQW5ILENBQUEsRUFBQTJKLENBQUEsRUFBQUMsQ0FBQTs7QUFFQTlELFdBQUFPLFVBQUEsQ0FBQXpFLEtBQUEsQ0FBQWlJLFNBQUEsR0FBQSxJQUFBLElBQUE7QUFDQS9ELFdBQUFPLFVBQUEsQ0FBQXpFLEtBQUEsQ0FBQW1JLE1BQUEsR0FBQSxJQUFBLEdBQUE7QUFDQWpFLFdBQUFRLFVBQUEsQ0FBQTFFLEtBQUEsQ0FBQWlJLFNBQUEsR0FBQSxJQUFBLElBQUE7QUFDQS9ELFdBQUFRLFVBQUEsQ0FBQTFFLEtBQUEsQ0FBQW1JLE1BQUEsR0FBQSxJQUFBLEdBQUE7O0FBRUE7QUFDQWpFLFdBQUFKLE9BQUEsQ0FBQTtBQUNBYyxlQUFBVixPQUFBVSxRQURBO0FBRUFHLFdBQUEsY0FBQUMsUUFBQSxFQUFBO0FBQ0FkLGFBQUFPLFVBQUEsQ0FBQXpFLEtBQUEsQ0FBQW1JLE1BQUEsR0FBQW5ELFdBQUEsR0FBQSxHQUFBLEdBQUE7QUFDQWQsYUFBQVEsVUFBQSxDQUFBMUUsS0FBQSxDQUFBbUksTUFBQSxHQUFBbkQsV0FBQSxHQUFBLEdBQUEsR0FBQTtBQUNBZCxhQUFBQyxPQUFBLENBQUFuRSxLQUFBLENBQUFtRixPQUFBLEdBQUFILFFBQUE7QUFDQTtBQU5BLEtBQUE7QUFRQSxJQWpCQSxFQWlCQWQsT0FBQVUsUUFBQSxHQUFBLEdBakJBO0FBa0JBO0FBckxBLEVBQUE7QUF1TEEsQ0E1TEE7O0FDSEE7QUFDQSxDQUFBLFlBQUE7QUFDQXJILFVBQUFDLGdCQUFBLENBQUEsa0JBQUEsRUFBQSxZQUFBO0FBQ0EsTUFBQTRLLFlBQUE3SyxTQUFBOEssYUFBQSxDQUFBLFlBQUEsQ0FBQTs7QUFFQSxNQUFBRCxTQUFBLEVBQUE7QUFDQUEsYUFBQTVLLGdCQUFBLENBQUEsUUFBQSxFQUFBOEssS0FBQTtBQUNBOztBQUVBLFdBQUFBLEtBQUEsQ0FBQXhLLENBQUEsRUFBQTtBQUNBQSxLQUFBeUssY0FBQTtBQUNBLE9BQUFuRCxPQUFBO0FBQ0FrRCxXQUFBRixVQUFBRSxLQUFBLENBQUFFLEtBREE7QUFFQUMsY0FBQUwsVUFBQUssUUFBQSxDQUFBRDtBQUZBLElBQUE7O0FBS0FFLGVBQUEsUUFBQSxFQUFBTixTQUFBLEVBQUFoRCxJQUFBLEVBQUEsVUFBQUEsSUFBQSxFQUFBO0FBQ0EsUUFBQUEsU0FBQSxzQkFBQSxFQUFBO0FBQ0F1RCxjQUFBL0IsSUFBQSxHQUFBLFFBQUE7QUFDQTtBQUNBLElBSkE7QUFLQTtBQUNBLEVBcEJBO0FBcUJBLENBdEJBOztBQXdCQTtBQUNBLElBQUE4QixjQUFBLFNBQUFBLFdBQUEsQ0FBQTVDLEdBQUEsRUFBQThDLElBQUEsRUFBQXhELElBQUEsRUFBQXlELEVBQUEsRUFBQTtBQUNBLEtBQUFDLGtCQUFBRixLQUFBUCxhQUFBLENBQUEsU0FBQSxDQUFBO0FBQ0FTLGlCQUFBQyxTQUFBLEdBQUEsWUFBQTtBQUNBQyxVQUFBbEQsR0FBQSxFQUFBVixJQUFBLEVBQUEsVUFBQUEsSUFBQSxFQUFBO0FBQ0F3RCxPQUFBSyxLQUFBO0FBQ0FILGtCQUFBQyxTQUFBLEdBQUEzRCxJQUFBO0FBQ0EsTUFBQXlELEVBQUEsRUFBQTtBQUNBQSxNQUFBekQsSUFBQTtBQUNBO0FBQ0EsRUFOQTtBQU9BLENBVkE7O0FBWUE7QUFDQSxJQUFBNEQsV0FBQSxTQUFBQSxRQUFBLENBQUFsRCxHQUFBLEVBQUFWLElBQUEsRUFBQXlELEVBQUEsRUFBQTtBQUNBLEtBQUE3QyxNQUFBLElBQUFDLGNBQUEsRUFBQTtBQUNBRCxLQUFBRSxJQUFBLENBQUEsTUFBQSxFQUFBSixHQUFBLEVBQUEsSUFBQTtBQUNBRSxLQUFBa0QsZ0JBQUEsQ0FBQSxjQUFBLEVBQUEsa0JBQUE7QUFDQWxELEtBQUEvQixNQUFBLEdBQUEsVUFBQW5HLENBQUEsRUFBQTtBQUNBLE1BQUFxTCxlQUFBO0FBQ0EsTUFBQTtBQUNBQSxZQUFBQyxLQUFBQyxLQUFBLENBQUFyRCxJQUFBc0QsWUFBQSxDQUFBO0FBQ0EsR0FGQSxDQUVBLE9BQUF4TCxDQUFBLEVBQUE7QUFDQStLLE1BQUEsMEJBQUE7QUFDQTtBQUNBQSxLQUFBTSxPQUFBMUQsTUFBQTtBQUNBLEVBUkE7QUFTQU8sS0FBQUksSUFBQSxDQUFBZ0QsS0FBQUcsU0FBQSxDQUFBbkUsSUFBQSxDQUFBO0FBQ0EsQ0FkQSIsImZpbGUiOiJhcHAuanMiLCJzb3VyY2VzQ29udGVudCI6WyJcInVzZSBzdHJpY3RcIjtcclxuXHJcbihmdW5jdGlvbigpIHtcclxuXHQvL2ZvciBTVkctZWxlbWVudHMgaW4gSUVcclxuXHRzdmc0ZXZlcnlib2R5KCk7IFxyXG59KSgpO1xyXG5cclxuLy/Qt9Cw0L/Rg9GB0YLQuNGC0Ywg0LrQsNC60YPRji3Qu9C40LHQviDRhNGD0L3QutGG0LjRjiwg0LXRgdC70LggZWxlbWVudCDRgdGD0YnQtdGB0YLQstGD0LXRgiDQvdCwINGB0YLRgNCw0L3QuNGG0LVcclxubGV0IGZvckVsZW1lbnQgPSBmdW5jdGlvbihlbGVtZW50KSB7XHJcblx0cmV0dXJuIG5ldyBQcm9taXNlKGZ1bmN0aW9uKHJlc29sdmUpIHtcclxuXHRcdGlmKGVsZW1lbnQpIHtcclxuXHRcdFx0cmVzb2x2ZSgpO1xyXG5cdFx0fVxyXG5cdH0pO1xyXG59O1xyXG5cclxuLy/Qv9GA0L7QstC10YDQutCwINC90LAg0LzQvtCx0LjQu9GM0L3QvtC1INGD0YHRgtGA0L7QudGB0YLQstC+XHJcbmxldCBpc01vYmlsZSA9IHtcclxuICAgIEFuZHJvaWQ6IGZ1bmN0aW9uKCkgeyByZXR1cm4gbmF2aWdhdG9yLnVzZXJBZ2VudC5tYXRjaCgvQW5kcm9pZC9pKTsgfSxcclxuICAgIEJsYWNrQmVycnk6IGZ1bmN0aW9uKCkgeyByZXR1cm4gbmF2aWdhdG9yLnVzZXJBZ2VudC5tYXRjaCgvQmxhY2tCZXJyeS9pKTsgfSxcclxuICAgIGlPUzogZnVuY3Rpb24oKSB7IHJldHVybiBuYXZpZ2F0b3IudXNlckFnZW50Lm1hdGNoKC9pUGhvbmV8aVBhZHxpUG9kL2kpOyB9LFxyXG4gICAgT3BlcmE6IGZ1bmN0aW9uKCkgeyByZXR1cm4gbmF2aWdhdG9yLnVzZXJBZ2VudC5tYXRjaCgvT3BlcmEgTWluaS9pKTsgfSxcclxuICAgIFdpbmRvd3M6IGZ1bmN0aW9uKCkgeyByZXR1cm4gbmF2aWdhdG9yLnVzZXJBZ2VudC5tYXRjaCgvSUVNb2JpbGUvaSk7IH0sXHJcblxyXG4gICAgYW55OiBmdW5jdGlvbigpIHtcclxuICAgICAgICByZXR1cm4gKGlzTW9iaWxlLkFuZHJvaWQoKSB8fCBpc01vYmlsZS5CbGFja0JlcnJ5KCkgfHwgaXNNb2JpbGUuaU9TKCkgfHwgaXNNb2JpbGUuT3BlcmEoKSB8fCBpc01vYmlsZS5XaW5kb3dzKCkpO1xyXG4gICAgfVxyXG59OyIsIi8vRmxpcCBlZmZlY3RcclxuKGZ1bmN0aW9uKCkge1xyXG5cdGRvY3VtZW50LmFkZEV2ZW50TGlzdGVuZXIoXCJET01Db250ZW50TG9hZGVkXCIsIGZ1bmN0aW9uKCkge1xyXG5cclxuICAgIFx0bGV0IGF1dGhvcml6ZSA9IGRvY3VtZW50LmdldEVsZW1lbnRCeUlkKFwiYXV0aG9yaXplXCIpLFxyXG5cdFx0XHRmbGlwQ2xhc3MgPSBcImZsaXBwZXJcIjtcclxuXHJcblx0XHQvL2xvZ2luIGZvcm1cclxuXHRcdGlmKGF1dGhvcml6ZSkge1xyXG5cdFx0XHRhdXRob3JpemUuYWRkRXZlbnRMaXN0ZW5lcihcImNsaWNrXCIsIHJ1bkZsaXApO1xyXG5cclxuXHRcdFx0Ly/Qv9C10YDQtdCy0LXRgNC90YPRgtGMINC60LDRgNGC0YMg0L/RgNC4INC60LvQuNC60LUg0LLQvdC1INC10LVcclxuXHRcdFx0ZG9jdW1lbnQuYm9keS5hZGRFdmVudExpc3RlbmVyKFwiY2xpY2tcIiwgZnVuY3Rpb24oZSkge1xyXG5cdFx0XHRcdGlmKCFlKSBlID0gd2luZG93LmV2ZW50O1xyXG5cdFx0XHRcdGxldCBlbGVtcyA9IGUucGF0aCxcclxuXHRcdFx0XHRcdGZsYWcgPSB0cnVlO1xyXG5cclxuXHRcdFx0XHRmb3IobGV0IGkgPSAwOyBpIDwgZWxlbXMubGVuZ3RoOyBpKyspIHtcclxuXHRcdFx0XHRcdGlmKGVsZW1zW2ldLmlkID09PSBcImF1dGhvcml6ZVwiIHx8IGVsZW1zW2ldLmlkID09PSBcImxvZ2luXCIpIHtcclxuXHRcdFx0XHRcdFx0ZmxhZyA9IGZhbHNlO1x0XHJcblx0XHRcdFx0XHR9XHJcblx0XHRcdFx0fVxyXG5cclxuXHRcdFx0XHRpZihmbGFnKSBkb2N1bWVudC5nZXRFbGVtZW50QnlJZChcImxvZ2luXCIpLmNsYXNzTGlzdC5yZW1vdmUoZmxpcENsYXNzKTtcclxuXHRcdFx0fSk7XHJcblx0XHR9XHJcblx0XHRcclxuXHJcblx0XHQvL2ZsaXAgZWZmZWN0XHJcblx0XHRmdW5jdGlvbiBydW5GbGlwKCkge1xyXG5cdFx0XHRsZXQgZWxlbSA9IGRvY3VtZW50LmdldEVsZW1lbnRCeUlkKHRoaXMuZGF0YXNldC5mbGlwSWQpLFxyXG5cdFx0XHRcdGNsYXNzZXMgPSBlbGVtLmNsYXNzTGlzdDtcclxuXHJcblx0XHRcdGNsYXNzZXMuY29udGFpbnMoZmxpcENsYXNzKSA9PT0gdHJ1ZSA/IGNsYXNzZXMucmVtb3ZlKGZsaXBDbGFzcykgOiBjbGFzc2VzLmFkZChmbGlwQ2xhc3MpO1xyXG5cdFx0fVxyXG5cdH0pO1xyXG59KSgpO1xyXG4iLCIvL1BhcmFsbGF4XHJcbihmdW5jdGlvbiAoKSB7XHJcblx0ZG9jdW1lbnQuYWRkRXZlbnRMaXN0ZW5lcihcIkRPTUNvbnRlbnRMb2FkZWRcIiwgZnVuY3Rpb24gKCkge1xyXG5cdFx0bGV0IGxheWVycyA9IGRvY3VtZW50LmdldEVsZW1lbnRzQnlDbGFzc05hbWUoXCJwYXJhbGxheF9fbGF5ZXJcIiksXHJcblx0XHRcdHBhcmFsbGF4ID0gZG9jdW1lbnQuZ2V0RWxlbWVudEJ5SWQoXCJwYXJhbGxheFwiKSxcclxuXHRcdFx0d3JhcHBlciA9IGRvY3VtZW50LmdldEVsZW1lbnRzQnlDbGFzc05hbWUoXCJ3cmFwcGVyXCIpWzBdLFxyXG5cdFx0XHRub1BhcmFsbGF4ID0gZG9jdW1lbnQuY3JlYXRlRWxlbWVudChcImRpdlwiKTtcclxuXHJcblx0XHRsZXQgbW92ZUxhZXJzID0gZnVuY3Rpb24gKGUpIHtcclxuXHRcdFx0ZSA9IGUgfHwgZXZlbnQ7XHJcblxyXG5cdFx0XHRsZXQgaW5pdGlhbFggPSAod2luZG93LmlubmVyV2lkdGggLyAyKSAtIGUucGFnZVgsXHJcblx0XHRcdFx0aW5pdGlhbFkgPSAod2luZG93LmlubmVySGVpZ2h0IC8gMikgLSBlLnBhZ2VZO1xyXG5cclxuXHRcdFx0Zm9yIChsZXQgaSA9IDA7IGkgPCBsYXllcnMubGVuZ3RoOyBpKyspIHtcclxuXHRcdFx0XHRsZXQgZGl2aWRlcjtcclxuXHJcblx0XHRcdFx0aWYgKGxheWVycy5sZW5ndGggPj0gNSkgZGl2aWRlciA9IGkgLyAxMDA7XHJcblx0XHRcdFx0ZWxzZSBkaXZpZGVyID0gKGkgKyAxKSAvIDEwMDtcclxuXHJcblx0XHRcdFx0bGV0IFggPSBpbml0aWFsWCAqIGRpdmlkZXIsXHJcblx0XHRcdFx0XHRZID0gaW5pdGlhbFkgKiBkaXZpZGVyLFxyXG5cdFx0XHRcdFx0dHJhbnNmb3JtU3R5bGUgPSBcInRyYW5zbGF0ZTNkKFwiICsgWCArIFwicHgsIFwiICsgWSArIFwicHgsIFwiICsgXCIwKVwiO1xyXG5cclxuXHRcdFx0XHRsYXllcnNbaV0uc3R5bGUudHJhbnNmb3JtID0gdHJhbnNmb3JtU3R5bGU7XHJcblx0XHRcdH1cclxuXHRcdH07XHJcblxyXG5cdFx0aWYoaXNNb2JpbGUuYW55KCkpIHtcclxuXHRcdFx0d3JhcHBlci5yZW1vdmVDaGlsZChwYXJhbGxheCk7XHJcblx0XHRcdG5vUGFyYWxsYXguY2xhc3NOYW1lID0gXCJwYXJhbGxheCBiZ19mb3Jlc3QtYm90dG9tXCI7XHJcblx0XHRcdHdyYXBwZXIuaW5zZXJ0QmVmb3JlKG5vUGFyYWxsYXgsIGRvY3VtZW50LmdldEVsZW1lbnRzQnlDbGFzc05hbWUoXCJmb290ZXJcIilbMF0pO1xyXG5cclxuXHRcdH0gZWxzZSB7XHJcblx0XHRcdHdpbmRvdy5hZGRFdmVudExpc3RlbmVyKFwibW91c2Vtb3ZlXCIsIG1vdmVMYWVycyk7XHJcblx0XHR9XHJcblx0fSk7XHJcbn0pKCk7XHJcbiIsIi8vTWFpbiBtZW51XHJcbi8valF1ZXJ5XHJcbiQoZnVuY3Rpb24oKSB7XHJcblx0JCgnI3RvZ2dsZScpLm9uKCdjbGljaycsIGZ1bmN0aW9uICgpIHtcclxuXHRcdCQodGhpcykudG9nZ2xlQ2xhc3MoJ2hhbWJ1cmdlcl9vbicpO1xyXG5cdFx0JCgnI21haW4tbWVudScpLnRvZ2dsZUNsYXNzKCdtYWluLW1lbnVfdGFyZ2V0Jyk7XHJcblx0fSk7XHJcbn0pO1xyXG4iLCIvL1ByZWxvYWRlclxyXG4vL2pRdWVyeVxyXG5sZXQgcHJlbG9hZGVyID0gKGZ1bmN0aW9uICgpIHtcclxuXHRsZXQgcGVyY2VudHMgPSAwLFxyXG5cdFx0cHJlbG9hZGVyID0gJChcIiNwcmVsb2FkZXJcIik7XHJcblxyXG5cdGxldCBpbWdQYXRoID0gJChcIipcIikubWFwKGZ1bmN0aW9uIChpLCBlbCkge1xyXG5cdFx0bGV0IGJnID0gJChlbCkuY3NzKFwiYmFja2dyb3VuZC1pbWFnZVwiKSxcclxuXHRcdFx0aW1nID0gJChlbCkuaXMoXCJpbWdcIiksXHJcblx0XHRcdHBhdGggPSBcIlwiO1xyXG5cclxuXHRcdGlmIChiZyAhPSBcIm5vbmVcIikge1xyXG5cdFx0XHRwYXRoID0gYmcucmVwbGFjZSgndXJsKFwiJywgJycpLnJlcGxhY2UoJ1wiKScsICcnKTs7XHJcblx0XHR9XHJcblxyXG5cdFx0aWYgKGltZykge1xyXG5cdFx0XHRwYXRoID0gJChlbCkuYXR0cihcInNyY1wiKTtcclxuXHRcdH1cclxuXHJcblx0XHRpZiAocGF0aCkgcmV0dXJuIHBhdGg7XHJcblx0fSk7XHJcblxyXG5cdGxldCBzZXRQZXJjZW50cyA9IGZ1bmN0aW9uICh0b3RhbCwgY3VycmVudCkge1xyXG5cdFx0bGV0IHBlcnNlbnRzID0gTWF0aC5jZWlsKGN1cnJlbnQgLyB0b3RhbCAqIDEwMCk7XHJcblxyXG5cdFx0JChcIiNwZXJjcm50c1wiKS50ZXh0KHBlcnNlbnRzKTtcclxuXHJcblx0XHRpZiAocGVyc2VudHMgPj0gMTAwKSB7XHJcblx0XHRcdHByZWxvYWRlci5mYWRlT3V0KCk7XHJcblx0XHR9XHJcblx0fVxyXG5cclxuXHRsZXQgbG9hZEltYWdlcyA9IGZ1bmN0aW9uIChpbWFnZXMpIHtcclxuXHJcblx0XHRpZiAoIWltYWdlcy5sZW5ndGgpIHByZWxvYWRlci5mYWRlT3V0KCk7XHJcblxyXG5cdFx0aW1hZ2VzLmZvckVhY2goZnVuY3Rpb24gKGltZywgaSwgaW1hZ2VzKSB7XHJcblx0XHRcdGxldCBmYWtlSW1hZ2UgPSAkKFwiPGltZz5cIiwge1xyXG5cdFx0XHRcdGF0dHI6IHtcclxuXHRcdFx0XHRcdHNyYzogaW1nXHJcblx0XHRcdFx0fVxyXG5cdFx0XHR9KTtcclxuXHJcblx0XHRcdGZha2VJbWFnZS5vbihcImxvYWQgZXJyb3JcIiwgZnVuY3Rpb24gKCkge1xyXG5cdFx0XHRcdHBlcmNlbnRzKys7XHJcblx0XHRcdFx0c2V0UGVyY2VudHMoaW1hZ2VzLmxlbmd0aCwgcGVyY2VudHMpO1xyXG5cdFx0XHR9KTtcclxuXHRcdH0pO1xyXG5cdH1cclxuXHJcblx0cmV0dXJuIHtcclxuXHRcdGluaXQ6IGZ1bmN0aW9uICgpIHtcclxuXHRcdFx0bGV0IGltZ3MgPSBpbWdQYXRoLnRvQXJyYXkoKTtcclxuXHJcblx0XHRcdGxvYWRJbWFnZXMoaW1ncyk7XHJcblx0XHR9XHJcblx0fVxyXG59KCkpO1xyXG5cclxuXHJcbiQoZnVuY3Rpb24gKCkge1xyXG5cdHByZWxvYWRlci5pbml0KCk7XHJcbn0pO1xyXG4iLCIvL1NpZGViYXJcclxuLy9qUXVlcnlcclxubGV0IGJsb2cgPSBkb2N1bWVudC5nZXRFbGVtZW50QnlJZChcImJsb2dcIik7XHJcblxyXG4vL9C10YHQu9C4INGN0LvQtdC80LXQvdGCIGJsb2cg0YHRg9GJ0LXRgdGC0LLRg9C10YJcclxuZm9yRWxlbWVudChibG9nKS50aGVuKGZ1bmN0aW9uICgpIHtcclxuXHQvL9C80L7QtNGD0LvRjCBTaWRlYmFyXHJcblx0bGV0IHNjcm9sbFNpZGViYXIgPSAoZnVuY3Rpb24gKCkge1xyXG5cdFx0bGV0IHNpZGViYXIgPSAkKFwiLnNpZGViYXJcIiksXHJcblx0XHRcdG1lbnUgPSAkKFwiLnNpZGViYXItbmF2XCIpLFxyXG5cdFx0XHRsaW5rID0gJChcIi5zaWRlYmFyX19saW5rXCIpLFxyXG5cdFx0XHRhcnRpY2xlID0gJChcIi5hcnRpY2xlXCIpLFxyXG5cdFx0XHRib2R5ID0gZG9jdW1lbnQuYm9keSxcclxuXHRcdFx0aXNQb3NpdGlvbkFydGljbGUgPSBbXSxcclxuXHRcdFx0b2Zmc2V0SGVpZ2h0ID0gJChcIi5ibG9nX19jb250ZW50XCIpWzBdLm9mZnNldFRvcCAtICQoXCIubWFpblwiKVswXS5vZmZzZXRUb3A7XHJcblxyXG5cdFx0bGV0IHBvc2l0aW9uQXJ0aWNsZSA9IGZ1bmN0aW9uIChlbCkge1xyXG5cdFx0XHRmb3IgKGxldCBpID0gMDsgaSA8IGVsLmxlbmd0aDsgaSsrKSB7XHJcblx0XHRcdFx0aXNQb3NpdGlvbkFydGljbGVbaV0gPSB7fTtcclxuXHRcdFx0XHRpc1Bvc2l0aW9uQXJ0aWNsZVtpXS50b3AgPSBlbFxyXG5cdFx0XHRcdFx0LmVxKGkpXHJcblx0XHRcdFx0XHQub2Zmc2V0KClcclxuXHRcdFx0XHRcdC50b3AgLSBvZmZzZXRIZWlnaHQ7XHJcblx0XHRcdFx0aXNQb3NpdGlvbkFydGljbGVbaV0uYm90dG9tID0gaXNQb3NpdGlvbkFydGljbGVbaV0udG9wICsgZWxcclxuXHRcdFx0XHRcdC5lcShpKVxyXG5cdFx0XHRcdFx0LmlubmVySGVpZ2h0KCk7XHJcblx0XHRcdH1cclxuXHRcdH07XHJcblxyXG5cdFx0bGV0IG1lbnVGaXhlZCA9IGZ1bmN0aW9uICgpIHtcclxuXHRcdFx0bGV0IHNjcm9sbCA9IHdpbmRvdy5wYWdlWU9mZnNldDtcclxuXHJcblx0XHRcdGlmIChzY3JvbGwgPCBhcnRpY2xlLm9mZnNldCgpLnRvcCkge1xyXG5cdFx0XHRcdHNpZGViYXIucmVtb3ZlQ2xhc3MoXCJmaXhlZFwiKTtcclxuXHRcdFx0XHQkKFwiLmJsb2dfX2NvbnRlbnRcIikucmVtb3ZlQ2xhc3MoXCJuYXYtZml4ZWRcIik7XHJcblx0XHRcdH1cclxuXHRcdFx0ZWxzZSB7XHJcblx0XHRcdFx0c2lkZWJhci5hZGRDbGFzcyhcImZpeGVkXCIpO1xyXG5cdFx0XHRcdCQoXCIuYmxvZ19fY29udGVudFwiKS5hZGRDbGFzcyhcIm5hdi1maXhlZFwiKTtcclxuXHRcdFx0fVxyXG5cdFx0fTtcclxuXHJcblx0XHRsZXQgc2Nyb2xsUGFnZSA9IGZ1bmN0aW9uIChlKSB7XHJcblx0XHRcdGxldCBzY3JvbGwgPSB3aW5kb3cucGFnZVlPZmZzZXQ7XHJcblxyXG5cdFx0XHRmb3IgKGxldCBpID0gMDsgaSA8IGlzUG9zaXRpb25BcnRpY2xlLmxlbmd0aDsgaSsrKSB7XHJcblx0XHRcdFx0aWYgKHNjcm9sbCA+PSBpc1Bvc2l0aW9uQXJ0aWNsZVtpXS50b3AgJiYgc2Nyb2xsIDw9IGlzUG9zaXRpb25BcnRpY2xlW2ldLmJvdHRvbSkge1xyXG5cdFx0XHRcdFx0bGlua1xyXG5cdFx0XHRcdFx0XHQuZXEoaSlcclxuXHRcdFx0XHRcdFx0LmFkZENsYXNzKFwic2lkZWJhcl9fbGlua19hY3RpdmVcIilcclxuXHRcdFx0XHRcdFx0LnNpYmxpbmdzKClcclxuXHRcdFx0XHRcdFx0LnJlbW92ZUNsYXNzKFwic2lkZWJhcl9fbGlua19hY3RpdmVcIik7XHJcblx0XHRcdFx0fVxyXG5cdFx0XHR9XHJcblx0XHR9O1xyXG5cclxuXHRcdGxldCBjbGlja09uTWVudSA9IGZ1bmN0aW9uIChlKSB7XHJcblx0XHRcdGxldCBpbmRleCA9ICQoZS50YXJnZXQpLmluZGV4KCk7XHJcblx0XHRcdGxldCBzZWN0aW9uT2Zmc2V0ID0gYXJ0aWNsZVxyXG5cdFx0XHRcdC5lcShpbmRleClcclxuXHRcdFx0XHQub2Zmc2V0KClcclxuXHRcdFx0XHQudG9wO1xyXG5cdFx0XHQkKGRvY3VtZW50KS5vZmYoXCJzY3JvbGxcIiwgc2Nyb2xsUGFnZSk7XHJcblx0XHRcdCQoXCJib2R5LCBodG1sXCIpLmFuaW1hdGUoe1xyXG5cdFx0XHRcdFwic2Nyb2xsVG9wXCI6IHNlY3Rpb25PZmZzZXRcclxuXHRcdFx0fSwgZnVuY3Rpb24gKCkge1xyXG5cdFx0XHRcdCQoZS50YXJnZXQpXHJcblx0XHRcdFx0XHQuYWRkQ2xhc3MoXCJzaWRlYmFyX19saW5rX2FjdGl2ZVwiKVxyXG5cdFx0XHRcdFx0LnNpYmxpbmdzKClcclxuXHRcdFx0XHRcdC5yZW1vdmVDbGFzcyhcInNpZGViYXJfX2xpbmtfYWN0aXZlXCIpO1xyXG5cdFx0XHRcdCQoZG9jdW1lbnQpLm9uKFwic2Nyb2xsXCIsIHNjcm9sbFBhZ2UpO1xyXG5cdFx0XHR9KTtcclxuXHRcdH07XHJcblxyXG5cdFx0bGV0IGFkZExpc3RlbmVyID0gZnVuY3Rpb24gKCkge1xyXG5cdFx0XHQkKG1lbnUpLm9uKFwiY2xpY2tcIiwgY2xpY2tPbk1lbnUpO1xyXG5cclxuXHRcdFx0JChkb2N1bWVudCkub24oXCJzY3JvbGxcIiwgc2Nyb2xsUGFnZSk7XHJcblx0XHRcdCQoZG9jdW1lbnQpLm9uKFwic2Nyb2xsXCIsIG1lbnVGaXhlZCk7XHJcblxyXG5cdFx0XHQkKHdpbmRvdykub24oXCJsb2FkXCIsIGZ1bmN0aW9uIChlKSB7XHJcblx0XHRcdFx0cG9zaXRpb25BcnRpY2xlKGFydGljbGUpO1xyXG5cdFx0XHR9KVxyXG5cclxuXHRcdFx0JCh3aW5kb3cpLm9uKFwicmVzaXplXCIsIGZ1bmN0aW9uIChlKSB7XHJcblx0XHRcdFx0cG9zaXRpb25BcnRpY2xlKGFydGljbGUpO1xyXG5cdFx0XHR9KVxyXG5cdFx0fVxyXG5cclxuXHRcdHJldHVybiB7XHJcblx0XHRcdGluaXQ6IGFkZExpc3RlbmVyXHJcblx0XHR9XHJcblx0fSkoKTtcclxuXHJcblx0c2Nyb2xsU2lkZWJhci5pbml0KCk7XHJcblxyXG5cdC8vdG9nZ2xlIGNsYXNzIFxyXG5cdCQoXCIjYnRuXCIpLm9uKFwiY2xpY2tcIiwgZnVuY3Rpb24gKCkge1xyXG5cdFx0JChcIiNibG9nXCIpLnRvZ2dsZUNsYXNzKFwib25cIik7XHJcblx0fSk7XHJcbn0pO1x0XHJcbiIsIi8vU2xpZGVyXHJcbmxldCBzbGlkZXIgPSBkb2N1bWVudC5nZXRFbGVtZW50QnlJZChcInNsaWRlclwiKTtcclxuXHJcbmZvckVsZW1lbnQoc2xpZGVyKS50aGVuKGZ1bmN0aW9uKCkge1xyXG5cdHdpbmRvdy5vbmxvYWQgPSBmdW5jdGlvbigpIHtcclxuXHRcdFNsaWRlci5pbml0KCk7XHJcblx0fTtcclxuXHJcblx0bGV0IFNsaWRlciA9IHtcclxuXHRcdGluaXQoKSB7XHJcblx0XHRcdHRoaXMuZGlzcGxheSA9IGRvY3VtZW50LmdldEVsZW1lbnRCeUlkKFwiZGlzcGxheVwiKTtcclxuXHRcdFx0dGhpcy5oZWFkZXIgPSBkb2N1bWVudC5nZXRFbGVtZW50QnlJZChcImhlYWRlclwiKTtcclxuXHRcdFx0dGhpcy5kZXNjcmlwdGlvbiA9IGRvY3VtZW50LmdldEVsZW1lbnRCeUlkKFwiZGVzY3JpcHRpb25cIik7XHJcblx0XHRcdHRoaXMuc2l0ZUxpbmsgPSBkb2N1bWVudC5nZXRFbGVtZW50QnlJZChcInNpdGVMaW5rXCIpO1xyXG5cdFx0XHR0aGlzLmJ0blByZXcgPSBkb2N1bWVudC5nZXRFbGVtZW50QnlJZChcImJ0blByZXdcIik7XHJcblx0XHRcdHRoaXMuYnRuTmV4dCA9IGRvY3VtZW50LmdldEVsZW1lbnRCeUlkKFwiYnRuTmV4dFwiKTtcclxuXHRcdFx0dGhpcy5idG5QcmV3SW1nID0gZG9jdW1lbnQuZ2V0RWxlbWVudEJ5SWQoXCJidG5QcmV3SW1nXCIpO1xyXG5cdFx0XHR0aGlzLmJ0bk5leHRJbWcgPSBkb2N1bWVudC5nZXRFbGVtZW50QnlJZChcImJ0bk5leHRJbWdcIik7XHJcblx0XHRcdFxyXG5cdFx0XHR0aGlzLndvcmtzID0gW107XHJcblxyXG5cdFx0XHR0aGlzLmR1cmF0aW9uID0gMTAwMDtcclxuXHJcblx0XHRcdHRoaXMuZGlzcGxheS5hZGRFdmVudExpc3RlbmVyKFwiY2xpY2tcIiwgZnVuY3Rpb24oKSB7XHJcblx0XHRcdFx0U2xpZGVyLmFuaW1hdGUoe1xyXG5cdFx0XHRcdFx0ZHVyYXRpb246IDMwMDAsXHJcblx0XHRcdFx0XHR0aW1pbmc6IGZ1bmN0aW9uKHRpbWVGcmFjdGlvbikgeyByZXR1cm4gdGltZUZyYWN0aW9uOyB9LFxyXG5cdFx0XHRcdFx0ZHJhdzogZnVuY3Rpb24ocHJvZ3Jlc3MpIHtcclxuXHRcdFx0XHRcdFx0Y29uc29sZS5sb2cocHJvZ3Jlc3MpO1xyXG5cdFx0XHRcdFx0XHRTbGlkZXIuZGlzcGxheS5zdHlsZS5vcGFjaXR5ID0gcHJvZ3Jlc3M7XHJcblx0XHRcdFx0XHR9XHJcblx0XHRcdFx0fSk7XHJcblx0XHRcdH0pO1xyXG5cclxuXHRcdFx0Ly9BamF4XHJcblx0XHRcdHRoaXMuZGF0YShcIi9hc3NldHMvanNvbi9zbGlkZXIuanNvblwiKVxyXG5cdFx0XHRcdC50aGVuKGZ1bmN0aW9uKGRhdGFBcnJheSkge1xyXG5cdFx0XHRcdFx0Zm9yKGxldCBpID0gMDsgaSA8IGRhdGFBcnJheS5sZW5ndGg7IGkrKykge1xyXG5cdFx0XHRcdFx0XHRTbGlkZXIud29ya3MucHVzaChkYXRhQXJyYXlbaV0pO1xyXG5cdFx0XHRcdFx0XHRTbGlkZXIud29ya3NbaV0uaW5kZXggPSBpO1xyXG5cdFx0XHRcdFx0fVxyXG5cdFx0XHRcdFx0Ly/Qt9Cw0L/QvtC70L3QuNGC0Ywg0YHQu9Cw0LnQtNC10YAg0L/QtdGA0LLQvtC90LDRh9Cw0LvRjNC90YvQvNC4INC00LDQvdC90YvQvNC4XHJcblx0XHRcdFx0XHRTbGlkZXIuY2xpY2tpbmcoMCwgKGRhdGFBcnJheS5sZW5ndGggLSAxKSwgMSk7XHJcblx0XHRcdFx0fSlcclxuXHRcdFx0XHQuY2F0Y2goZnVuY3Rpb24oc3RhdHVzKSB7XHJcblx0XHRcdFx0XHRjb25zb2xlLmVycm9yKFwi0JrQvtC0INC+0YLQstC10YLQsDogXCIsIHN0YXR1cyk7XHJcblx0XHRcdFx0fSk7XHJcblxyXG5cclxuXHRcdFx0Ly9FdmVudHNcclxuXHRcdFx0dGhpcy5idG5QcmV3LmFkZEV2ZW50TGlzdGVuZXIoXCJjbGlja1wiLCBmdW5jdGlvbihldmVudCkge1xyXG5cdFx0XHRcdGxldCBpbmRleGVzID0gW1xyXG5cdFx0XHRcdFx0XHRTbGlkZXIuZGlzcGxheS5kYXRhc2V0LmluZGV4LCBcclxuXHRcdFx0XHRcdFx0U2xpZGVyLmJ0blByZXdJbWcuZGF0YXNldC5pbmRleCwgXHJcblx0XHRcdFx0XHRcdFNsaWRlci5idG5OZXh0SW1nLmRhdGFzZXQuaW5kZXhcclxuXHRcdFx0XHRcdF07XHJcblxyXG5cdFx0XHRcdFNsaWRlci50b2dnbGVJbmRleGVzKGluZGV4ZXMsIFwibWludXNcIik7XHJcblx0XHRcdFx0U2xpZGVyLmFkZEFuaW1hdGUoaW5kZXhlc1swXSwgaW5kZXhlc1sxXSwgaW5kZXhlc1syXSk7XHJcblx0XHRcdH0pO1xyXG5cclxuXHRcdFx0dGhpcy5idG5OZXh0LmFkZEV2ZW50TGlzdGVuZXIoXCJjbGlja1wiLCBmdW5jdGlvbigpIHtcclxuXHRcdFx0XHRsZXQgaW5kZXhlcyA9IFtcclxuXHRcdFx0XHRcdFx0U2xpZGVyLmRpc3BsYXkuZGF0YXNldC5pbmRleCwgXHJcblx0XHRcdFx0XHRcdFNsaWRlci5idG5QcmV3SW1nLmRhdGFzZXQuaW5kZXgsIFxyXG5cdFx0XHRcdFx0XHRTbGlkZXIuYnRuTmV4dEltZy5kYXRhc2V0LmluZGV4XHJcblx0XHRcdFx0XHRdO1xyXG5cclxuXHRcdFx0XHRTbGlkZXIudG9nZ2xlSW5kZXhlcyhpbmRleGVzLCBcInBsdXNcIik7XHJcblx0XHRcdFx0U2xpZGVyLmFkZEFuaW1hdGUoaW5kZXhlc1swXSwgaW5kZXhlc1sxXSwgaW5kZXhlc1syXSk7XHJcblx0XHRcdH0pO1xyXG5cdFx0fSxcclxuXHRcdFxyXG5cdFx0ZGF0YSh1cmwpIHtcclxuXHRcdFx0cmV0dXJuIG5ldyBQcm9taXNlKGZ1bmN0aW9uKHJlc29sdmUsIHJlamVjdCkge1xyXG5cdFx0XHRcdGxldCB4aHIgPSBuZXcgWE1MSHR0cFJlcXVlc3QoKTtcclxuXHRcdFx0XHR4aHIub3BlbihcIkdFVFwiLCB1cmwsIHRydWUpO1xyXG5cdFx0XHRcdHhoci5yZXNwb25zZVR5cGUgPSBcImpzb25cIjtcclxuXHRcdFx0XHR4aHIuc2VuZCgpO1xyXG5cdFx0XHRcdHhoci5vbnJlYWR5c3RhdGVjaGFuZ2UgPSBmdW5jdGlvbigpIHtcclxuXHRcdFx0XHRcdGlmKHhoci5yZWFkeVN0YXRlICE9PSA0KSByZXR1cm47XHJcblx0XHRcdFx0XHRpZih4aHIuc3RhdHVzICE9PSAyMDApIHtcclxuXHRcdFx0XHRcdFx0cmVqZWN0KHhoci5zdGF0dXMpO1xyXG5cdFx0XHRcdFx0fSBlbHNlIHtcclxuXHRcdFx0XHRcdFx0cmVzb2x2ZSh4aHIucmVzcG9uc2UpO1xyXG5cdFx0XHRcdFx0fVxyXG5cdFx0XHRcdH07XHJcblx0XHRcdH0pO1xyXG5cdFx0fSxcclxuXHJcblx0XHRhZGRUZXh0QmxvY2soaW5kZXgpIHtcclxuXHRcdFx0dGhpcy5oZWFkZXIuaW5uZXJUZXh0ID0gdGhpcy53b3Jrc1tpbmRleF0udGl0bGU7XHJcblx0XHRcdHRoaXMuZGVzY3JpcHRpb24uaW5uZXJUZXh0ID0gdGhpcy53b3Jrc1tpbmRleF0uZGVzYztcclxuXHRcdFx0dGhpcy5zaXRlTGluay5ocmVmID0gdGhpcy53b3Jrc1tpbmRleF0ubGluaztcclxuXHRcdH0sXHJcblxyXG5cdFx0YWRkRGlzcGxheShpbmRleCkge1xyXG5cdFx0XHR0aGlzLmRpc3BsYXkuc3JjID0gdGhpcy53b3Jrc1tpbmRleF0uaW1hZ2U7XHJcblx0XHRcdHRoaXMuZGlzcGxheS5hbHQgPSB0aGlzLndvcmtzW2luZGV4XS50aXRsZTtcclxuXHRcdFx0dGhpcy5kaXNwbGF5LmRhdGFzZXQuaW5kZXggPSBpbmRleDtcclxuXHRcdH0sXHJcblxyXG5cdFx0YWRkTmV4dEltZyhpbmRleCkge1xyXG5cdFx0XHR0aGlzLmJ0bk5leHRJbWcuc3JjID0gdGhpcy53b3Jrc1tpbmRleF0ucHJldmlldztcclxuXHRcdFx0dGhpcy5idG5OZXh0SW1nLmFsdCA9IHRoaXMud29ya3NbaW5kZXhdLnRpdGxlO1xyXG5cdFx0XHR0aGlzLmJ0bk5leHRJbWcuZGF0YXNldC5pbmRleCA9IGluZGV4O1xyXG5cdFx0fSxcclxuXHJcblx0XHRhZGRQcmV3SW1nKGluZGV4KSB7XHJcblx0XHRcdHRoaXMuYnRuUHJld0ltZy5zcmMgPSB0aGlzLndvcmtzW2luZGV4XS5wcmV2aWV3O1xyXG5cdFx0XHR0aGlzLmJ0blByZXdJbWcuYWx0ID0gdGhpcy53b3Jrc1tpbmRleF0udGl0bGU7XHJcblx0XHRcdHRoaXMuYnRuUHJld0ltZy5kYXRhc2V0LmluZGV4ID0gaW5kZXg7XHJcblx0XHR9LFxyXG5cclxuXHRcdGNsaWNraW5nKGRpc3BsYXlJbmRleCwgcHJld0luZGV4LCBuZXh0SW5kZXgpIHtcclxuXHRcdFx0Ly9tYWluIGNvbnRlbnQgaW4gdGhlIHNsaWRlcjogYmlnIHBpY3R1cmUsIHRpdGxlLCBkZXNjcmlwdGlvbiBhbmQgbGlua1xyXG5cdFx0XHR0aGlzLmFkZERpc3BsYXkoZGlzcGxheUluZGV4KTtcclxuXHRcdFx0dGhpcy5hZGRUZXh0QmxvY2soZGlzcGxheUluZGV4KTtcclxuXHRcdFx0Ly9zbWFsbCBpbWFnZSBvbiB0aGUgYnV0dG9uIFwicHJldmlvdXMgd29ya1wiXHJcblx0XHRcdHRoaXMuYWRkUHJld0ltZyhwcmV3SW5kZXgpO1xyXG5cdFx0XHQvL3NtYWxsIGltYWdlIG9uIHRoZSBidXR0b24gXCJuZXh0IHdvcmtcIlxyXG5cdFx0XHR0aGlzLmFkZE5leHRJbWcobmV4dEluZGV4KTtcclxuXHRcdH0sXHJcblxyXG5cdFx0dG9nZ2xlSW5kZXhlcyhhcnIsIHR5cGUpIHtcclxuXHRcdFx0bGV0IG1heCA9IHRoaXMud29ya3MubGVuZ3RoIC0gMTtcclxuXHJcblx0XHRcdGZvcihsZXQgaSA9IDA7IGkgPCBhcnIubGVuZ3RoOyBpKyspIHtcclxuXHRcdFx0XHRzd2l0Y2godHlwZSkge1xyXG5cdFx0XHRcdFx0Y2FzZSBcInBsdXNcIiA6XHJcblx0XHRcdFx0XHRcdGlmKGFycltpXSA9PSBtYXgpIGFycltpXSA9IDA7XHJcblx0XHRcdFx0XHRcdGVsc2UgYXJyW2ldKys7XHJcblx0XHRcdFx0XHRcdGJyZWFrO1xyXG5cdFx0XHRcdFx0Y2FzZSBcIm1pbnVzXCIgOlxyXG5cdFx0XHRcdFx0XHRpZihhcnJbaV0gPT0gMCkgYXJyW2ldID0gbWF4O1xyXG5cdFx0XHRcdFx0XHRlbHNlIGFycltpXS0tO1xyXG5cdFx0XHRcdFx0XHRicmVhaztcclxuXHRcdFx0XHR9XHJcblx0XHRcdH1cclxuXHRcdH0sXHJcblx0XHRcclxuXHRcdGFuaW1hdGUob3B0aW9ucykge1xyXG5cdFx0XHRsZXQgc3RhcnQgPSBwZXJmb3JtYW5jZS5ub3coKTtcclxuXHJcblx0XHRcdHJlcXVlc3RBbmltYXRpb25GcmFtZShmdW5jdGlvbiBhbmltYXRlKHRpbWUpIHtcclxuXHRcdFx0XHQvLyB0aW1lRnJhY3Rpb24g0L7RgiAwINC00L4gMVxyXG5cdFx0XHRcdGxldCB0aW1lRnJhY3Rpb24gPSAodGltZSAtIHN0YXJ0KSAvIG9wdGlvbnMuZHVyYXRpb247XHJcblx0XHRcdFx0aWYgKHRpbWVGcmFjdGlvbiA+IDEpIHRpbWVGcmFjdGlvbiA9IDE7XHJcblxyXG5cdFx0XHRcdC8vINGC0LXQutGD0YnQtdC1INGB0L7RgdGC0L7Rj9C90LjQtSDQsNC90LjQvNCw0YbQuNC4XHJcblx0XHRcdFx0bGV0IHByb2dyZXNzID0gdGltZUZyYWN0aW9uO1xyXG5cdFx0XHRcdC8v0YTRg9C90LrRhtC40Y8sINC+0L/QuNGB0YvQstCw0Y7RidCw0Y8g0LDQvdC40LzQsNGG0LjRjlxyXG5cdFx0XHRcdG9wdGlvbnMuZHJhdyhwcm9ncmVzcyk7XHJcblxyXG5cdFx0XHRcdGlmICh0aW1lRnJhY3Rpb24gPCAxKSB7XHJcblx0XHRcdFx0XHRyZXF1ZXN0QW5pbWF0aW9uRnJhbWUoYW5pbWF0ZSk7XHJcblx0XHRcdFx0fVxyXG5cdFx0XHR9KTtcclxuXHRcdH0sXHJcblxyXG5cdFx0YWRkQW5pbWF0ZShpLCBqLCBrKSB7XHJcblx0XHRcdC8v0LDQvdC40LzQsNGG0LjRjyDQtNC+INC/0LXRgNC10LrQu9GO0YfQtdC90LjRjyDRgdC70LDQudC00LBcclxuXHRcdFx0U2xpZGVyLmFuaW1hdGUoe1xyXG5cdFx0XHRcdGR1cmF0aW9uOiBTbGlkZXIuZHVyYXRpb24sXHJcblx0XHRcdFx0ZHJhdzogZnVuY3Rpb24gKHByb2dyZXNzKSB7XHJcblx0XHRcdFx0XHRTbGlkZXIuYnRuUHJld0ltZy5zdHlsZS5tYXJnaW5Ub3AgPSBwcm9ncmVzcyAqIDYwMCArIFwicHhcIjtcclxuXHRcdFx0XHRcdFNsaWRlci5idG5OZXh0SW1nLnN0eWxlLm1hcmdpblRvcCA9IHByb2dyZXNzICogLTYwMCArIFwicHhcIjtcclxuXHRcdFx0XHRcdFNsaWRlci5kaXNwbGF5LnN0eWxlLm9wYWNpdHkgPSAxIC0gcHJvZ3Jlc3M7XHJcblx0XHRcdFx0fVxyXG5cdFx0XHR9KTtcclxuXHJcblx0XHRcdHNldFRpbWVvdXQoZnVuY3Rpb24gKCkge1xyXG5cdFx0XHRcdFNsaWRlci5jbGlja2luZyhpLCBqLCBrKTtcclxuXHJcblx0XHRcdFx0U2xpZGVyLmJ0blByZXdJbWcuc3R5bGUubWFyZ2luVG9wID0gMCArIFwicHhcIjtcclxuXHRcdFx0XHRTbGlkZXIuYnRuUHJld0ltZy5zdHlsZS5oZWlnaHQgPSAwICsgXCIlXCI7XHJcblx0XHRcdFx0U2xpZGVyLmJ0bk5leHRJbWcuc3R5bGUubWFyZ2luVG9wID0gMCArIFwicHhcIjtcclxuXHRcdFx0XHRTbGlkZXIuYnRuTmV4dEltZy5zdHlsZS5oZWlnaHQgPSAwICsgXCIlXCI7XHJcblxyXG5cdFx0XHRcdC8v0LDQvdC40LzQsNGG0LjRjyDQv9C+0YHQu9C1INC/0LXRgNC10LrQu9GO0YfQtdC90LjRjyDRgdC70LDQudC00LBcclxuXHRcdFx0XHRTbGlkZXIuYW5pbWF0ZSh7XHJcblx0XHRcdFx0XHRkdXJhdGlvbjogU2xpZGVyLmR1cmF0aW9uLFxyXG5cdFx0XHRcdFx0ZHJhdzogZnVuY3Rpb24gKHByb2dyZXNzKSB7XHJcblx0XHRcdFx0XHRcdFNsaWRlci5idG5QcmV3SW1nLnN0eWxlLmhlaWdodCA9IHByb2dyZXNzICogMTAwICsgXCIlXCI7XHJcblx0XHRcdFx0XHRcdFNsaWRlci5idG5OZXh0SW1nLnN0eWxlLmhlaWdodCA9IHByb2dyZXNzICogMTAwICsgXCIlXCI7XHJcblx0XHRcdFx0XHRcdFNsaWRlci5kaXNwbGF5LnN0eWxlLm9wYWNpdHkgPSBwcm9ncmVzcztcclxuXHRcdFx0XHRcdH1cclxuXHRcdFx0XHR9KTtcclxuXHRcdFx0fSwgKFNsaWRlci5kdXJhdGlvbiArIDEwMCkpO1xyXG5cdFx0fVxyXG5cdH1cclxufSk7XHJcbiIsIi8vTG9naW5cclxuKGZ1bmN0aW9uKCkge1xyXG5cdGRvY3VtZW50LmFkZEV2ZW50TGlzdGVuZXIoXCJET01Db250ZW50TG9hZGVkXCIsIGZ1bmN0aW9uKCkge1xyXG5cdFx0Y29uc3QgbG9naW5Gb3JtID0gZG9jdW1lbnQucXVlcnlTZWxlY3RvcihcIiNsb2dpbkZvcm1cIik7XHJcblxyXG5cdFx0aWYobG9naW5Gb3JtKSB7XHJcblx0XHRcdGxvZ2luRm9ybS5hZGRFdmVudExpc3RlbmVyKFwic3VibWl0XCIsIGxvZ2luKTtcclxuXHRcdH1cclxuXHJcblx0XHRmdW5jdGlvbiBsb2dpbihlKSB7XHJcblx0XHRcdGUucHJldmVudERlZmF1bHQoKTtcclxuXHRcdFx0bGV0IGRhdGEgPSB7XHJcblx0XHRcdFx0bG9naW46IGxvZ2luRm9ybS5sb2dpbi52YWx1ZSxcclxuXHRcdFx0XHRwYXNzd29yZDogbG9naW5Gb3JtLnBhc3N3b3JkLnZhbHVlXHJcblx0XHRcdH07XHJcblxyXG5cdFx0XHRwcmVwYXJlU2VuZChcIi9sb2dpblwiLCBsb2dpbkZvcm0sIGRhdGEsIGZ1bmN0aW9uKGRhdGEpIHtcclxuXHRcdFx0XHRpZihkYXRhID09PSBcItCQ0LLRgtC+0YDQuNC30LDRhtC40Y8g0YPRgdC/0LXRiNC90LAhXCIpIHtcclxuXHRcdFx0XHRcdGxvY2F0aW9uLmhyZWYgPSBcIi9hZG1pblwiO1xyXG5cdFx0XHRcdH1cclxuXHRcdFx0fSk7XHJcblx0XHR9XHJcblx0fSk7XHJcbn0pKCk7XHJcblxyXG4vL3ByZXBhcmVTZW5kXHJcbnZhciBwcmVwYXJlU2VuZCA9IGZ1bmN0aW9uKHVybCwgZm9ybSwgZGF0YSwgY2IpIHtcclxuICBsZXQgcmVzdWx0Q29udGFpbmVyID0gZm9ybS5xdWVyeVNlbGVjdG9yKCcuc3RhdHVzJyk7XHJcbiAgcmVzdWx0Q29udGFpbmVyLmlubmVySFRNTCA9ICdTZW5kaW5nLi4uJztcclxuICBzZW5kQWpheCh1cmwsIGRhdGEsIGZ1bmN0aW9uIChkYXRhKSB7XHJcbiAgICBmb3JtLnJlc2V0KCk7XHJcbiAgICByZXN1bHRDb250YWluZXIuaW5uZXJIVE1MID0gZGF0YTtcclxuICAgIGlmIChjYikge1xyXG4gICAgICBjYihkYXRhKTtcclxuICAgIH1cclxuICB9KTtcclxufTtcclxuXHJcbi8vQWpheFxyXG52YXIgc2VuZEFqYXggPSBmdW5jdGlvbih1cmwsIGRhdGEsIGNiKSB7XHJcbiAgbGV0IHhociA9IG5ldyBYTUxIdHRwUmVxdWVzdCgpO1xyXG4gIHhoci5vcGVuKCdQT1NUJywgdXJsLCB0cnVlKTtcclxuICB4aHIuc2V0UmVxdWVzdEhlYWRlcignQ29udGVudC1UeXBlJywgJ2FwcGxpY2F0aW9uL2pzb24nKTtcclxuICB4aHIub25sb2FkID0gZnVuY3Rpb24gKGUpIHtcclxuICAgIGxldCByZXN1bHQ7XHJcbiAgICB0cnkge1xyXG4gICAgICByZXN1bHQgPSBKU09OLnBhcnNlKHhoci5yZXNwb25zZVRleHQpO1xyXG4gICAgfSBjYXRjaCAoZSkge1xyXG4gICAgICBjYign0JjQt9Cy0LjQvdC40YLQtSDQsiDQtNCw0L3QvdGL0YUg0L7RiNC40LHQutCwJyk7XHJcbiAgICB9XHJcbiAgICBjYihyZXN1bHQuc3RhdHVzKTtcclxuICB9O1xyXG4gIHhoci5zZW5kKEpTT04uc3RyaW5naWZ5KGRhdGEpKTtcclxufTsiXX0=
